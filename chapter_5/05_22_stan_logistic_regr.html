
<!DOCTYPE html>


<html lang="it" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Regressione logistica con Stan &#8212; ds4p</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=384b581d" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/proof.css?v=ca93fcec" />
    <link rel="stylesheet" type="text/css" href="../_static/exercise.css?v=20b57f81" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=3ee479438cf8b5e0d341" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=3ee479438cf8b5e0d341" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=3ee479438cf8b5e0d341"></script>

    <script src="../_static/documentation_options.js?v=8d586cc4"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=efea14e4"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script src="../_static/translations.js?v=0173e136"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=36754332"></script>
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-TP2WLBPMS6"></script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-TP2WLBPMS6');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-TP2WLBPMS6');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script type="application/vnd.jupyter.widget-state+json">{"state": {"000c2e0303c74e34848c287f2321146d": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "FloatProgressModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "FloatProgressModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "ProgressView", "bar_style": "success", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_50aeb091a26446ddbd64853e3731dbce", "max": 2000.0, "min": 0.0, "orientation": "horizontal", "style": "IPY_MODEL_e0e48f2a4843498dbb5e8ca3ba799b6d", "tabbable": null, "tooltip": null, "value": 2000.0}}, "005c439396ce4816863a3a0cd88ed103": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_49f272a7fada44f986a8ed7ff9393815", "placeholder": "\u200b", "style": "IPY_MODEL_9d930e2d48944c87889967720805d55a", "tabbable": null, "tooltip": null, "value": "\u20072000/2000\u2007[00:00&lt;00:00,\u20072657.86it/s]"}}, "066e2b135ecc4446b918625ebe6f100a": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "FloatProgressModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "FloatProgressModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "ProgressView", "bar_style": "success", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_97d601a94be5407ea4bd76b91d202e79", "max": 2000.0, "min": 0.0, "orientation": "horizontal", "style": "IPY_MODEL_eba40aae26f045cc85b8174a2f7e1377", "tabbable": null, "tooltip": null, "value": 2000.0}}, "06dbe5fdf54b477cb2c3022565402bc0": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "0d881cbd520f4227841650c2ab970be8": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "0edf073f16fc488790423d05bcf94905": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "172d37566f7944eda0c0b4d62dfc9f3b": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "ProgressStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "ProgressStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "bar_color": null, "description_width": ""}}, "1a5193371e8f43c1ab7e14a030e7eda3": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "1b65855d097d47f7aaf0c8781c356611": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_1b869588ef06475986da8c069af47b22", "placeholder": "\u200b", "style": "IPY_MODEL_e79a9575f0f748e2aedb656d621fb75d", "tabbable": null, "tooltip": null, "value": "Running\u2007chain\u20072:\u2007100%"}}, "1b869588ef06475986da8c069af47b22": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "1e6331acf8374a8b975d1ffa9dddfd68": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "213f7e993c25435ca656b37a7e343606": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "FloatProgressModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "FloatProgressModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "ProgressView", "bar_style": "success", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_2b58ce9f21de4d5691e19ea5c2c93db2", "max": 2000.0, "min": 0.0, "orientation": "horizontal", "style": "IPY_MODEL_e5d58820ccc3406e8ab453c844fd71d1", "tabbable": null, "tooltip": null, "value": 2000.0}}, "22cee0859ce1429487a1c7594b05bd3a": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "256f64d1f55c4a098e8375416a478d89": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "270a95c1de9a44578b4dda3d37c7f3a9": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_443601d578054c319b15e4290ee53ec3", "placeholder": "\u200b", "style": "IPY_MODEL_3e0bbdff86344a129725ec4ea27a90da", "tabbable": null, "tooltip": null, "value": "Running\u2007chain\u20072:\u2007100%"}}, "293139819f9744c4a6e658ee1a5d0a78": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "FloatProgressModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "FloatProgressModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "ProgressView", "bar_style": "success", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_769183435dbb41c3b357d85c78bfc780", "max": 2000.0, "min": 0.0, "orientation": "horizontal", "style": "IPY_MODEL_6e5057baa8eb48399244d81a0116fb5f", "tabbable": null, "tooltip": null, "value": 2000.0}}, "2a0ff2e5b9ac4624a01ab444bccce148": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_0d881cbd520f4227841650c2ab970be8", "placeholder": "\u200b", "style": "IPY_MODEL_1a5193371e8f43c1ab7e14a030e7eda3", "tabbable": null, "tooltip": null, "value": "Running\u2007chain\u20070:\u2007100%"}}, "2b58ce9f21de4d5691e19ea5c2c93db2": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "2e70849b7b1c480bafe4d03076483b52": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "31b4079f0dda4fc0b6f0933209462c49": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HBoxModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_49035289d7434dc89cf41c52a23a9d08", "IPY_MODEL_000c2e0303c74e34848c287f2321146d", "IPY_MODEL_5c644affe57b4251891cd8c194a5a924"], "layout": "IPY_MODEL_4d6c9103faf646b7a95e88a3bdc10216", "tabbable": null, "tooltip": null}}, "358fe036f10e4fd49490337fd4971ad1": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "3a223ed536eb452eaaea8876d8d182ff": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "3c9821ec12fa401fa9fdd034af08f1b2": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "3ce56c1d9db24fea90223637c9063583": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "3cf0d7eb270147bfab2f9f2166dc0c26": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "3e0bbdff86344a129725ec4ea27a90da": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "443601d578054c319b15e4290ee53ec3": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "475a736ab8504f12b07efb6bc3565555": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "484f61cd86ae482da8bee64b5b810279": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "FloatProgressModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "FloatProgressModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "ProgressView", "bar_style": "success", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_c92ab06290b444b2a25d4adc1bca6ab4", "max": 2000.0, "min": 0.0, "orientation": "horizontal", "style": "IPY_MODEL_64e967a2587e49deade212abf46f77ed", "tabbable": null, "tooltip": null, "value": 2000.0}}, "49035289d7434dc89cf41c52a23a9d08": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_3cf0d7eb270147bfab2f9f2166dc0c26", "placeholder": "\u200b", "style": "IPY_MODEL_8200b7531c774c79a24bd5ec82032fe9", "tabbable": null, "tooltip": null, "value": "Running\u2007chain\u20073:\u2007100%"}}, "49f272a7fada44f986a8ed7ff9393815": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "4c79ca0f485c4eb996eb4e222f1900eb": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "4d6c9103faf646b7a95e88a3bdc10216": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "4d886682247c4f35b1ef26d57b48502f": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "FloatProgressModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "FloatProgressModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "ProgressView", "bar_style": "success", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_06dbe5fdf54b477cb2c3022565402bc0", "max": 2000.0, "min": 0.0, "orientation": "horizontal", "style": "IPY_MODEL_d71d8756489643f99c18fb811dc45774", "tabbable": null, "tooltip": null, "value": 2000.0}}, "4e44d425e8b542c4a924ea2408c6137f": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "4fe0bc5ea2d84031af482e7d451feb06": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HBoxModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_5c18738c09ea43368adc8f949fda6e17", "IPY_MODEL_066e2b135ecc4446b918625ebe6f100a", "IPY_MODEL_8bb5b655759f41efbbf612004562a15c"], "layout": "IPY_MODEL_4c79ca0f485c4eb996eb4e222f1900eb", "tabbable": null, "tooltip": null}}, "50aeb091a26446ddbd64853e3731dbce": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "52af49a4317442c09ea10ac633f50ce9": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "545267d34b6b4b92ba9bbe8a21964209": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "55db9d7462c74ec0934bd8bb4ea58918": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "57b1e1cb0423495c97c61759d65984c8": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_22cee0859ce1429487a1c7594b05bd3a", "placeholder": "\u200b", "style": "IPY_MODEL_2e70849b7b1c480bafe4d03076483b52", "tabbable": null, "tooltip": null, "value": "Running\u2007chain\u20071:\u2007100%"}}, "57f19333d7b548dda5d0517d99727011": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_3ce56c1d9db24fea90223637c9063583", "placeholder": "\u200b", "style": "IPY_MODEL_c788e54c25cb46e4a1dd2d4767c75c03", "tabbable": null, "tooltip": null, "value": "\u20072000/2000\u2007[00:00&lt;00:00,\u20072691.36it/s]"}}, "5c18738c09ea43368adc8f949fda6e17": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_545267d34b6b4b92ba9bbe8a21964209", "placeholder": "\u200b", "style": "IPY_MODEL_358fe036f10e4fd49490337fd4971ad1", "tabbable": null, "tooltip": null, "value": "Running\u2007chain\u20071:\u2007100%"}}, "5c644affe57b4251891cd8c194a5a924": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_3a223ed536eb452eaaea8876d8d182ff", "placeholder": "\u200b", "style": "IPY_MODEL_d2cce5cc73564131b689a9afd9e47d3a", "tabbable": null, "tooltip": null, "value": "\u20072000/2000\u2007[00:00&lt;00:00,\u20072304.80it/s]"}}, "5d8155ef23a94bd3a023ca5f0c2fac3f": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HBoxModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_b0c12cdbc8e743bc8af6802649c91ba8", "IPY_MODEL_a87c606f7a3c4073aa5a1da36ea86ba8", "IPY_MODEL_57f19333d7b548dda5d0517d99727011"], "layout": "IPY_MODEL_89d7198d3c8d45178c4cef151da9d3ca", "tabbable": null, "tooltip": null}}, "5ef7fb8e4d3f4389a64c65ff48eceb0c": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HBoxModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_57b1e1cb0423495c97c61759d65984c8", "IPY_MODEL_dddf8653376d4f77b05f8240fdd981ef", "IPY_MODEL_6cd0df3554314d7e88b66140d756ba7b"], "layout": "IPY_MODEL_8c83b91d15c748e485886a40abba6659", "tabbable": null, "tooltip": null}}, "5f96f5c8638e41efaaf2f57837ee8138": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "64e967a2587e49deade212abf46f77ed": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "ProgressStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "ProgressStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "bar_color": null, "description_width": ""}}, "64f247dc2f3444d583dfb323e2977aa3": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "6cd0df3554314d7e88b66140d756ba7b": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_8b7bd3aa995e495a9f1ccad2b95a7068", "placeholder": "\u200b", "style": "IPY_MODEL_b46911f241fb4ca6b846973ab7bf2772", "tabbable": null, "tooltip": null, "value": "\u20072000/2000\u2007[00:00&lt;00:00,\u20072292.72it/s]"}}, "6e5057baa8eb48399244d81a0116fb5f": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "ProgressStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "ProgressStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "bar_color": null, "description_width": ""}}, "6f86e65f7e75427ebbac605b1d4807ff": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "70856b87befe41faa357c732b6b8a3c6": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HBoxModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_2a0ff2e5b9ac4624a01ab444bccce148", "IPY_MODEL_293139819f9744c4a6e658ee1a5d0a78", "IPY_MODEL_891019a7dbac407bb88bdcb948f6cd11"], "layout": "IPY_MODEL_475a736ab8504f12b07efb6bc3565555", "tabbable": null, "tooltip": null}}, "769183435dbb41c3b357d85c78bfc780": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "76a9c342dfa7488cab291417e4c0a25a": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_9d9fbd9efd9f4152a86ee54b282797c8", "placeholder": "\u200b", "style": "IPY_MODEL_c67a7c93b55343998eb6f4c577bb8b6c", "tabbable": null, "tooltip": null, "value": "\u20072000/2000\u2007[00:00&lt;00:00,\u20072298.95it/s]"}}, "7ff9100cb1ad4044a03eddc8a8f978ec": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "8200b7531c774c79a24bd5ec82032fe9": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "832726e0d4e642159aeb895c3a1e2682": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HBoxModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_d3a1ad036358438faf6884dc640897a1", "IPY_MODEL_213f7e993c25435ca656b37a7e343606", "IPY_MODEL_005c439396ce4816863a3a0cd88ed103"], "layout": "IPY_MODEL_3c9821ec12fa401fa9fdd034af08f1b2", "tabbable": null, "tooltip": null}}, "85aa182fdf1448089309436e792c6eda": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "87b3719dfe7443058775db8205482812": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HBoxModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_270a95c1de9a44578b4dda3d37c7f3a9", "IPY_MODEL_484f61cd86ae482da8bee64b5b810279", "IPY_MODEL_af9b9e15f03b481cbe77e9babc733970"], "layout": "IPY_MODEL_cc6ccab600db468d9dd402952056b278", "tabbable": null, "tooltip": null}}, "891019a7dbac407bb88bdcb948f6cd11": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_85aa182fdf1448089309436e792c6eda", "placeholder": "\u200b", "style": "IPY_MODEL_55db9d7462c74ec0934bd8bb4ea58918", "tabbable": null, "tooltip": null, "value": "\u20072000/2000\u2007[00:00&lt;00:00,\u20072285.99it/s]"}}, "89d7198d3c8d45178c4cef151da9d3ca": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "8b7bd3aa995e495a9f1ccad2b95a7068": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "8bb5b655759f41efbbf612004562a15c": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_256f64d1f55c4a098e8375416a478d89", "placeholder": "\u200b", "style": "IPY_MODEL_7ff9100cb1ad4044a03eddc8a8f978ec", "tabbable": null, "tooltip": null, "value": "\u20072000/2000\u2007[00:00&lt;00:00,\u20072674.09it/s]"}}, "8c83b91d15c748e485886a40abba6659": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "97d601a94be5407ea4bd76b91d202e79": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "9badf7570e9b4ca4a201bdde2476f2ba": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HBoxModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_1b65855d097d47f7aaf0c8781c356611", "IPY_MODEL_4d886682247c4f35b1ef26d57b48502f", "IPY_MODEL_76a9c342dfa7488cab291417e4c0a25a"], "layout": "IPY_MODEL_4e44d425e8b542c4a924ea2408c6137f", "tabbable": null, "tooltip": null}}, "9d930e2d48944c87889967720805d55a": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "9d9fbd9efd9f4152a86ee54b282797c8": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "a87c606f7a3c4073aa5a1da36ea86ba8": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "FloatProgressModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "FloatProgressModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "ProgressView", "bar_style": "success", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_b5ace3f639914048b1668ad57e38600b", "max": 2000.0, "min": 0.0, "orientation": "horizontal", "style": "IPY_MODEL_c273db1fce1a439483a1f68b31e6852e", "tabbable": null, "tooltip": null, "value": 2000.0}}, "af9b9e15f03b481cbe77e9babc733970": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_6f86e65f7e75427ebbac605b1d4807ff", "placeholder": "\u200b", "style": "IPY_MODEL_52af49a4317442c09ea10ac633f50ce9", "tabbable": null, "tooltip": null, "value": "\u20072000/2000\u2007[00:00&lt;00:00,\u20072683.82it/s]"}}, "b0c12cdbc8e743bc8af6802649c91ba8": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_64f247dc2f3444d583dfb323e2977aa3", "placeholder": "\u200b", "style": "IPY_MODEL_cd144545141b431ebf3cc4549692bf3d", "tabbable": null, "tooltip": null, "value": "Running\u2007chain\u20073:\u2007100%"}}, "b46911f241fb4ca6b846973ab7bf2772": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "b5ace3f639914048b1668ad57e38600b": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "c273db1fce1a439483a1f68b31e6852e": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "ProgressStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "ProgressStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "bar_color": null, "description_width": ""}}, "c67a7c93b55343998eb6f4c577bb8b6c": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "c788e54c25cb46e4a1dd2d4767c75c03": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "c92ab06290b444b2a25d4adc1bca6ab4": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "cc6ccab600db468d9dd402952056b278": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "cd144545141b431ebf3cc4549692bf3d": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "d2cce5cc73564131b689a9afd9e47d3a": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "d3a1ad036358438faf6884dc640897a1": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_1e6331acf8374a8b975d1ffa9dddfd68", "placeholder": "\u200b", "style": "IPY_MODEL_5f96f5c8638e41efaaf2f57837ee8138", "tabbable": null, "tooltip": null, "value": "Running\u2007chain\u20070:\u2007100%"}}, "d71d8756489643f99c18fb811dc45774": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "ProgressStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "ProgressStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "bar_color": null, "description_width": ""}}, "dddf8653376d4f77b05f8240fdd981ef": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "FloatProgressModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "FloatProgressModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "ProgressView", "bar_style": "success", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_0edf073f16fc488790423d05bcf94905", "max": 2000.0, "min": 0.0, "orientation": "horizontal", "style": "IPY_MODEL_172d37566f7944eda0c0b4d62dfc9f3b", "tabbable": null, "tooltip": null, "value": 2000.0}}, "e0e48f2a4843498dbb5e8ca3ba799b6d": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "ProgressStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "ProgressStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "bar_color": null, "description_width": ""}}, "e5d58820ccc3406e8ab453c844fd71d1": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "ProgressStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "ProgressStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "bar_color": null, "description_width": ""}}, "e79a9575f0f748e2aedb656d621fb75d": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "eba40aae26f045cc85b8174a2f7e1377": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "ProgressStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "ProgressStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "bar_color": null, "description_width": ""}}}, "version_major": 2, "version_minor": 0}</script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script crossorigin="anonymous" data-jupyter-widgets-cdn="https://cdn.jsdelivr.net/npm/" src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@1.0.6/dist/embed-amd.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'chapter_5/05_22_stan_logistic_regr';</script>
    <link rel="canonical" href="https://ccaudek.github.io/ds4p/chapter_5/05_22_stan_logistic_regr.html" />
    <link rel="icon" href="../_static/increasing.png"/>
    <link rel="index" title="Indice" href="../genindex.html" />
    <link rel="search" title="Cerca" href="../search.html" />
    <link rel="next" title="Modelli misti con Stan" href="05_24_stan_mixed_models.html" />
    <link rel="prev" title=" Esercizi" href="E_causal_inference.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="it"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="ds4p - Home"/>
    <script>document.write(`<img src="../_static/logo.png" class="logo__image only-dark" alt="ds4p - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Cerca" aria-label="Cerca" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Cerca</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Benvenuti
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../chapter_1/introduction_chapter_1.html">Python</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../chapter_1/00_prelims.html">Preliminari</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_1/01_python_1.html">Python (1)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_1/02_python_2.html">Python (2)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_1/ex_python.html"> Esercizi</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_1/03_numpy.html">NumPy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_1/ex_numpy.html"> Esercizi</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_1/04_pandas.html">Pandas (1)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_1/05_pandas_aggregate.html">Pandas (2)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_1/06_pandas_functions.html">Pandas (3)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_1/ex_pandas.html"> Esercizi</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_1/07_matplotlib.html">Matplotlib</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_1/08_seaborn.html">Seaborn</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_1/ex_matplotlib.html"> Esercizi</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../chapter_2/introduction_chapter_2.html">Statistica descrittiva</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../chapter_2/00_scientific_method.html">La scienza dei dati e il metodo scientifico</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_2/01_key_notions.html">Concetti chiave</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_2/E_key_notions.html"> Esercizi</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_2/02_measurement.html">La misurazione in psicologia</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_2/E_scales.html"> Esercizi</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_2/03_freq_distr.html">Dati e frequenze</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_2/E_sums.html"> Esercizi</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_2/04_loc_scale.html">Indici di posizione e di scala</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_2/05_correlation.html">Le relazioni tra variabili</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_2/06_causality.html">Lo studio delle cause dei fenomeni</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_2/E_eda.html"> Esercizi</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_2/E_mehr_song_spelke.html"> Esercizi</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../chapter_3/introduction_chapter_3.html">Probabilit</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../chapter_3/01_intro_prob.html">Introduzione al calcolo delle probabilit</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_3/E_prob.html"> Esercizi</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_3/02_conditional_prob.html">Probabilit condizionata</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_3/E_cond_prob_1.html"> Esercizi</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_3/E_cond_prob_2.html"> Esercizi</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_3/E_discrete_prob.html"> Esercizi</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_3/03_bayes_theorem.html">Il teorema di Bayes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_3/E_bayes_theorem.html"> Esercizi</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_3/E_bayes_theorem_2.html"> Esercizi</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_3/04a_random_var.html">Introduzione alle variabili casuali</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_3/04b_expval_var.html">Propriet delle variabili casuali</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_3/E_exp_val_variance.html"> Esercizi</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_3/04c_sampling_distr.html">Stime, stimatori e parametri</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_3/E_rv_discrete.html"> Esercizi</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_3/05_joint_prob.html">Probabilit congiunta</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_3/E_joint_prob.html"> Esercizi</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_3/E_covariance.html"> Esercizi</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_3/06_density_func.html">La funzione di densit di probabilit</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_3/07_discr_rv_distr.html">Distribuzioni di v.c. discrete</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_3/E_binomial.html"> Esercizi</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_3/08_cont_rv_distr.html">Distribuzioni di v.c. continue</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_3/E_gaussian.html"> Esercizi</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_3/E_beta_distr.html"> Esercizi</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_3/09_likelihood.html">La verosimiglianza</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_3/E_likelihood.html"> Esercizi</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../chapter_4/introduction_part_4.html">Inferenza bayesiana</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../chapter_4/01_intro_bayes.html">Modellazione bayesiana</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_4/02_subj_prop.html">Pensare ad una proporzione in termini soggettivi</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_4/02_grid_gauss.html">Verosimiglianza Gaussiana: Metodo Basato su Griglia</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_4/03_conjugate_families_1.html">Distribuzioni coniugate</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_4/E_conjugate_families_1.html"> Esercizi</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_4/04_conjugate_families_2.html">Distribuzioni coniugate (2)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_4/05_summary_posterior.html">Sintesi a posteriori</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_4/E_conjugate.html"> Esercizi</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_4/06_balance-prior-post.html">Linfluenza della distribuzione a priori</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_4/10_metropolis.html">Monte Carlo a Catena di Markov</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_4/15_stan_beta_binomial.html">Introduzione a Stan</a></li>

<li class="toctree-l2"><a class="reference internal" href="../chapter_4/E_stan_beta_binomial.html"> Esercizio</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_4/16_stan_summary_posterior.html">Metodi di sintesi della distribuzione a posteriori</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_4/17_stan_diagnostics.html">Diagnostica delle catene markoviane</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_4/18_stan_prediction.html">La predizione bayesiana</a></li>

<li class="toctree-l2"><a class="reference internal" href="../chapter_4/19_stan_odds_ratio.html">Analisi bayesiana dellodds-ratio</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_4/22_stan_normal_normal.html">Inferenza bayesiana su una media</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_4/23_stan_two_groups.html">Confronto tra due gruppi</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_4/24_stan_hier_beta_binom.html">Modello gerarchico beta-binomiale con Stan</a></li>
</ul>
</details></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="introduction_part_5.html">Analisi della regressione</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="05_03_reglin_bayesian.html">Analisi bayesiana del modello di regressione lineare bivariato</a></li>
<li class="toctree-l2"><a class="reference internal" href="E_reglin_1.html"> Esercizi</a></li>
<li class="toctree-l2"><a class="reference internal" href="05_04_synt_sugar.html">Zucchero sintattico</a></li>
<li class="toctree-l2"><a class="reference internal" href="05_05_two_means.html">Confronto tra le medie di due gruppi</a></li>
<li class="toctree-l2"><a class="reference internal" href="E_reglin_2.html"> Esercizi</a></li>
<li class="toctree-l2"><a class="reference internal" href="E_reglin_3.html"> Esercizi</a></li>
<li class="toctree-l2"><a class="reference internal" href="E_reglin_4.html"> Esercizi</a></li>
<li class="toctree-l2"><a class="reference internal" href="05_06_hier_regr.html">Il modello lineare gerarchico</a></li>
<li class="toctree-l2"><a class="reference internal" href="05_07_robust_regr.html">Regressione robusta</a></li>
<li class="toctree-l2"><a class="reference internal" href="05_08_specification_error.html">Errore di specificazione</a></li>
<li class="toctree-l2"><a class="reference internal" href="05_09_causal_inference.html">Inferenza causale</a></li>
<li class="toctree-l2"><a class="reference internal" href="E_causal_inference.html"> Esercizi</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Regressione logistica con Stan</a></li>
<li class="toctree-l2"><a class="reference internal" href="05_24_stan_mixed_models.html">Modelli misti con Stan</a></li>
<li class="toctree-l2"><a class="reference internal" href="05_25_stan_rct.html">Incorporare dati storici di controllo in una RCT</a></li>
<li class="toctree-l2"><a class="reference internal" href="05_26_stan_mediation.html">Modello di mediazione con Stan</a></li>
<li class="toctree-l2"><a class="reference internal" href="05_30_entropy.html">Entropia</a></li>
<li class="toctree-l2"><a class="reference internal" href="05_31_kl.html">La divergenza di Kullback-Leibler</a></li>
<li class="toctree-l2"><a class="reference internal" href="E_kl.html"> Esercizi</a></li>
<li class="toctree-l2"><a class="reference internal" href="05_32_stan_loo.html">Validazione Incrociata Leave-One-Out</a></li>
<li class="toctree-l2"><a class="reference internal" href="05_35_missing.html">Dati mancanti</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../chapter_6/introduction_part_6.html">Inferenza frequentista</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../chapter_6/01_intro_frequentist.html">Introduzione allinferenza frequentista</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_6/E_estimation.html"> Esercizi</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_6/02_conf_interv.html">Intervallo di confidenza</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_6/E_conf_interv.html"> Esercizi</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_6/03_test_ipotesi.html">Significativit statistica</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_6/E_t_test.html"> Esercizi</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_6/E_interpretation_test.html"> Esercizi</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_6/E_significato_test.html"> Esercizi</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_6/04_two_ind_samples.html">Test t di Student per campioni indipendenti</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_6/E_test_media_pop.html"> Esercizi</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_6/E_medie_pop_ampie.html"> Esercizi</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_6/E_medie_pop_piccoli.html"> Esercizi</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_6/E_campioni_appaiati.html"> Esercizi</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_6/E_confronto_proporzioni.html"> Esercizi</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_6/05_crisis.html">La crisi della generalizzabilit</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_6/06_limiti_stat_frequentista.html">Limiti dellinferenza frequentista</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_6/07_effect_size.html">La grandezza delleffetto</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_6/09_s_m_errors.html">Crisi della replicabilit</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_6/10_integrity.html">Integrit della ricerca</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../references/bibliography.html">Bibliografia</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../chapter_7/introduction_appendix.html">Appendici</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../chapter_7/a00_installation.html">Ambiente di lavoro</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_7/a01_markdown.html">Jupyter Notebook</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_7/a02_shell.html">La Shell</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_7/a03_colab_tutorial.html">Colab: un breve tutorial</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_7/a04_virtual_env.html">Ambienti virtuali</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_7/a10_math_symbols.html">Simbologia di base</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_7/a11_numbers.html">Numeri binari, interi, razionali, irrazionali e reali</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_7/a12_sum_notation.html">Simbolo di somma (sommatorie)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_7/a13_sets.html">Insiemi</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_7/a13a_probability.html">Sigma algebra</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_7/a14_combinatorics.html">Calcolo combinatorio</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_7/a15_calculus.html">Per liberarvi dai terrori preliminari</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_7/a20_kde_plot.html">Kernel Density Estimation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_7/a30_prob_tutorial.html">Esercizi di probabilit discreta</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_7/a40_rng.html">Generazione di numeri casuali</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_7/a44_montecarlo.html">Simulazione Monte Carlo</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_7/a45_mcmc.html">Catene di Markov</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_7/a46_stan.html">Linguaggio Stan</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_7/a50_lin_fun.html">La funzione lineare</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_7/a50_reglin_ml.html">Modello di Regressione Bivariato e ML</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_7/a51_reglin_1.html">Regressione lineare bivariata</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_7/a60_ttest_exercises.html">Esercizi sullinferenza frequentista</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_7/a70_predict_counts.html">La predizione delle frequenze</a></li>
</ul>
</details></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://colab.research.google.com/github/ccaudek/ds4p/blob/main/docs/chapter_5/05_22_stan_logistic_regr.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onColab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Scarica questa pagina">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/chapter_5/05_22_stan_logistic_regr.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Scarica il file sorgente"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Stampa in PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Modalit schermo intero"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Cerca" aria-label="Cerca" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Regressione logistica con Stan</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contenuti </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#regressione-logistica-bivariata">Regressione Logistica Bivariata</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#preparazione-del-notebook">Preparazione del Notebook</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modello-di-regressione-logistica-per-variabili-binarie">Modello di Regressione Logistica per Variabili Binarie</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modello-lineare-nelle-probabilita">Modello Lineare nelle Probabilit</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#problemi-di-normalita">Problemi di Normalit</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#problematiche-di-eteroschedasticita">Problematiche di Eteroschedasticit</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#linearita">Linearit</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modello-lineare-nelle-probabilita-vincolato">Modello Lineare nelle Probabilit Vincolato</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#regressione-logistica">Regressione Logistica</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#vantaggi-della-regressione-logistica">Vantaggi della Regressione Logistica</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#esempio-pratico">Esempio Pratico</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#probabilita-odds-e-logit">Probabilit, Odds e Logit</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#trasformazione-inversa-del-logit">Trasformazione Inversa del Logit</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modelli-lineari-generalizzati">Modelli Lineari Generalizzati</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#componente-sistematica">Componente Sistematica</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#componente-aleatoria">Componente Aleatoria</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#funzione-legame">Funzione Legame</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Modelli Lineari Generalizzati</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#combinazioni-di-componenti-nei-glm">Combinazioni di Componenti nei GLM</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Componente Sistematica</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">Componente Aleatoria</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">Funzione Legame</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#coefficienti-del-modello-nella-regressione-logistica-e-la-loro-interpretazione">Coefficienti del Modello nella Regressione Logistica e la loro Interpretazione</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#interpretazione-sui-logit">Interpretazione sui Logit</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#interpretazione-sugli-odds-ratio-or">Interpretazione sugli Odds Ratio (OR)</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#interpretazione-sulla-scala-delle-probabilita">Interpretazione sulla Scala delle Probabilit</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#un-esempio-concreto">Un esempio concreto</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#interpretazione-dei-coefficienti-nella-regressione-logistica">Interpretazione dei Coefficienti nella Regressione Logistica</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#la-regola-del-dividere-per-4">La regola del dividere per 4</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#scala-dei-logit">Scala dei Logit</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#odds-ratio">Odds Ratio</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#scala-delle-probabilita">Scala delle Probabilit</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#riassunto">Riassunto</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#regressione-logistica-con-solo-l-intercetta">Regressione logistica con solo lintercetta</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#regressione-logistica-con-un-singolo-predittore-binario">Regressione logistica con un singolo predittore binario</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#informazioni-sull-ambiente-di-sviluppo">Informazioni sullAmbiente di Sviluppo</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="regressione-logistica-con-stan">
<span id="stan-reglin1-notebook"></span><h1>Regressione logistica con Stan<a class="headerlink" href="#regressione-logistica-con-stan" title="Link to this heading">#</a></h1>
<section id="regressione-logistica-bivariata">
<h2>Regressione Logistica Bivariata<a class="headerlink" href="#regressione-logistica-bivariata" title="Link to this heading">#</a></h2>
<p>La regressione logistica  un modello additivo utilizzato per dati binari, ossia dati <span class="math notranslate nohighlight">\( y \)</span> che assumono valori 0 o 1. Per modellare i dati binari, dobbiamo aggiungere due caratteristiche al modello base <span class="math notranslate nohighlight">\( y = a + bx \)</span>: una trasformazione non lineare che vincola loutput tra 0 e 1 (a differenza di <span class="math notranslate nohighlight">\( a + bx \)</span>, che  illimitato), e un metodo per interpretare i numeri risultanti come probabilit che un evento si verifichi.</p>
<p>In questo capitolo, approfondiremo la regressione logistica bivariata, un modello statistico che ci consente di analizzare le relazioni tra una variabile di esito binaria e una singola variabile indipendente. Esploreremo il processo di stima dei coefficienti del modello attraverso un approccio bayesiano e forniremo uninterpretazione dei risultati ottenuti. Mostreremo come i coefficienti influenzano la probabilit di successo della variabile binaria di esito, nonch come interpretare il loro segno e ampiezza.</p>
</section>
<section id="preparazione-del-notebook">
<h2>Preparazione del Notebook<a class="headerlink" href="#preparazione-del-notebook" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">arviz</span> <span class="k">as</span> <span class="nn">az</span>
<span class="kn">import</span> <span class="nn">scipy.stats</span> <span class="k">as</span> <span class="nn">stats</span>
<span class="kn">from</span> <span class="nn">scipy.special</span> <span class="kn">import</span> <span class="n">expit</span>  <span class="c1"># Funzione logistica</span>
<span class="kn">from</span> <span class="nn">statsmodels.nonparametric.smoothers_lowess</span> <span class="kn">import</span> <span class="n">lowess</span>
<span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="k">as</span> <span class="nn">sm</span>
<span class="kn">from</span> <span class="nn">cmdstanpy</span> <span class="kn">import</span> <span class="n">cmdstan_path</span><span class="p">,</span> <span class="n">CmdStanModel</span>
<span class="kn">import</span> <span class="nn">bambi</span> <span class="k">as</span> <span class="nn">bmb</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># set seed to make the results fully reproducible</span>
<span class="n">seed</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">ord</span><span class="p">,</span> <span class="s2">&quot;stan_logistic_regression&quot;</span><span class="p">))</span>
<span class="n">rng</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">Generator</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">)</span>

<span class="n">az</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s2">&quot;arviz-darkgrid&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;figure.dpi&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;figure.facecolor&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;white&quot;</span>

<span class="o">%</span><span class="k">config</span> InlineBackend.figure_format = &quot;retina&quot;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">scale_columns</span><span class="p">(</span><span class="n">dataframe</span><span class="p">,</span> <span class="n">columns_to_scale</span><span class="p">):</span>
    <span class="c1"># Work on a copy to avoid modifying the original DataFrame</span>
    <span class="n">df_scaled</span> <span class="o">=</span> <span class="n">dataframe</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">columns_to_scale</span><span class="p">:</span>
        <span class="c1"># Scale each specified column individually</span>
        <span class="n">df_scaled</span><span class="p">[</span><span class="n">column</span><span class="p">]</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">zscore</span><span class="p">(</span><span class="n">df_scaled</span><span class="p">[</span><span class="n">column</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">df_scaled</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="modello-di-regressione-logistica-per-variabili-binarie">
<h2>Modello di Regressione Logistica per Variabili Binarie<a class="headerlink" href="#modello-di-regressione-logistica-per-variabili-binarie" title="Link to this heading">#</a></h2>
<p>Il modello di regressione logistica  utilizzato per analizzare la relazione tra una variabile dipendente dicotomica, che assume i valori di successo e fallimento, e una o pi variabili indipendenti, che possono essere sia quantitative che qualitative. Qui ci concentreremo sul caso di una sola variabile indipendente.</p>
<p>Consideriamo <span class="math notranslate nohighlight">\(n\)</span> osservazioni i.i.d., dove <span class="math notranslate nohighlight">\(Y_i\)</span> indica losservazione <span class="math notranslate nohighlight">\(i\)</span>-esima della variabile risposta, per <span class="math notranslate nohighlight">\(i=1, \dots, n\)</span>. Ogni osservazione  associata a un vettore di variabili esplicative <span class="math notranslate nohighlight">\((x_1, \dots, x_p)\)</span>. La relazione che vogliamo esaminare  tra la probabilit di successo <span class="math notranslate nohighlight">\(\pi_i\)</span> e la variabile esplicativa, espressa dalla formula:</p>
<div class="math notranslate nohighlight">
\[
P(Y=1 \mid X=x_i) = \pi_i.
\]</div>
<p>In questo contesto, la variabile dipendente <span class="math notranslate nohighlight">\(Y\)</span> segue una distribuzione di Bernoulli, con i seguenti possibili valori:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
y_i = 
\begin{cases} 
    1 &amp; \text{per un successo (per l'osservazione $i$-esima)},\\
    0 &amp; \text{per un fallimento}.
\end{cases}
\end{split}\]</div>
<p>Le probabilit associate a questi valori sono rispettivamente <span class="math notranslate nohighlight">\(\pi\)</span> per il successo e <span class="math notranslate nohighlight">\(1-\pi\)</span> per il fallimento:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{aligned}
    P(Y_i = 1) &amp;= \pi,\\
    P(Y_i = 0) &amp;= 1-\pi.
\end{aligned}
\end{split}\]</div>
<p>Questo modello permette di studiare come le variabili esplicative influenzino la probabilit di un evento binario, come il successo o il fallimento.</p>
<p>La media condizionata <span class="math notranslate nohighlight">\(\mathbb{E}(Y \mid X=x)\)</span> in una popolazione pu essere vista come la proporzione di valori 1 per un dato punteggio <span class="math notranslate nohighlight">\(x\)</span> sulla variabile esplicativa, ovvero la probabilit condizionata <span class="math notranslate nohighlight">\(\pi_i\)</span> di osservare lesito <span class="math notranslate nohighlight">\(Y = 1\)</span> in corrispondenza di un certo livello <span class="math notranslate nohighlight">\(X\)</span>:</p>
<div class="math notranslate nohighlight">
\[
\pi_i \equiv P(Y = 1 \mid X = x).
\]</div>
<p>Il valore atteso diventa:</p>
<div class="math notranslate nohighlight">
\[
\mathbb{E}(Y \mid x) = \pi_i.
\]</div>
<p>Se <span class="math notranslate nohighlight">\(X\)</span>  una variabile discreta, possiamo calcolare la proporzione di <span class="math notranslate nohighlight">\(Y=1\)</span> per ogni valore di <span class="math notranslate nohighlight">\(X=x\)</span> nel campione. Queste proporzioni rappresentano una stima non parametrica della funzione di regressione di <span class="math notranslate nohighlight">\(Y\)</span> su <span class="math notranslate nohighlight">\(X\)</span>, e possono essere stimate tramite tecniche di smoothing.</p>
<p>Per valori bassi della variabile <span class="math notranslate nohighlight">\(X\)</span>, la proporzione condizionata di valori <span class="math notranslate nohighlight">\(Y=1\)</span> sar prossima allo 0. Per valori alti di <span class="math notranslate nohighlight">\(X\)</span>, la proporzione di valori <span class="math notranslate nohighlight">\(Y=1\)</span> sar prossima a 1. A livelli intermedi di <span class="math notranslate nohighlight">\(X\)</span>, la curva di regressione non parametrica gradualmente approssima i valori 0 e 1 seguendo un andamento sigmoidale.</p>
<p>Per illustrare, generiamo dei dati simulati con una variabile dicotomica <span class="math notranslate nohighlight">\(Y\)</span> e una variabile discreta <span class="math notranslate nohighlight">\(X\)</span> nei quali la probabilit che <span class="math notranslate nohighlight">\(Y=1\)</span> aumenta con il valore di <span class="math notranslate nohighlight">\(X\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Simulate data</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>  <span class="c1"># For reproducibility</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">1000</span>  <span class="c1"># Number of samples</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>  <span class="c1"># Discrete independent variable with levels from 0 to 9</span>

<span class="c1"># Define the logistic model</span>
<span class="k">def</span> <span class="nf">logistic</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">beta0</span><span class="p">,</span> <span class="n">beta1</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">expit</span><span class="p">(</span><span class="n">beta0</span> <span class="o">+</span> <span class="n">beta1</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span>

<span class="n">beta0</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span>
<span class="n">beta1</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># Increase the steepness of the curve</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">logistic</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">beta0</span><span class="p">,</span> <span class="n">beta1</span><span class="p">)</span>

<span class="c1"># Generate dichotomous outcome variable Y</span>
<span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">binomial</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>

<span class="c1"># Compute mean success rate and standard error for each level of X</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;X&#39;</span><span class="p">:</span> <span class="n">X</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">:</span> <span class="n">Y</span><span class="p">})</span>
<span class="n">mean_success_rate</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">)[</span><span class="s1">&#39;Y&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">standard_error</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">)[</span><span class="s1">&#39;Y&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sem</span><span class="p">()</span>

<span class="c1"># Plot mean success rates with standard errors</span>
<span class="n">sns</span><span class="o">.</span><span class="n">pointplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">mean_success_rate</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">mean_success_rate</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">capsize</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>  <span class="c1"># Use linestyle=&#39;none&#39; to avoid connecting lines</span>
<span class="n">plt</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">mean_success_rate</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">mean_success_rate</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">yerr</span><span class="o">=</span><span class="n">standard_error</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>

<span class="c1"># Fit a non-parametric smoother (LOESS) and plot the curve</span>
<span class="n">lowess_smoothed</span> <span class="o">=</span> <span class="n">lowess</span><span class="p">(</span><span class="n">mean_success_rate</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">mean_success_rate</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">frac</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lowess_smoothed</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">lowess_smoothed</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Non-parametric Smoother&#39;</span><span class="p">)</span>

<span class="c1"># Customizing the plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Mean Success Rate&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Display the plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="../_images/11b4021e2395753f6909aac153d5af0c92c6d273560fb8f3ae515f722aa5e9a9.png"><img alt="../_images/11b4021e2395753f6909aac153d5af0c92c6d273560fb8f3ae515f722aa5e9a9.png" src="../_images/11b4021e2395753f6909aac153d5af0c92c6d273560fb8f3ae515f722aa5e9a9.png" style="width: 731px; height: 491px;" /></a>
</div>
</div>
</section>
<section id="modello-lineare-nelle-probabilita">
<h2>Modello Lineare nelle Probabilit<a class="headerlink" href="#modello-lineare-nelle-probabilita" title="Link to this heading">#</a></h2>
<p>Potremmo pensare di usare una funzione lineare per rappresentare la dipendenza di <span class="math notranslate nohighlight">\(Y\)</span> da <span class="math notranslate nohighlight">\(X\)</span>. Introduciamo un modello lineare con le seguenti assunzioni standard:</p>
<div class="math notranslate nohighlight">
\[
Y_i = \alpha + \beta X_i + \varepsilon_i,
\]</div>
<p>dove <span class="math notranslate nohighlight">\(\varepsilon_i\)</span> segue una distribuzione normale con media 0 e varianza 1 (<span class="math notranslate nohighlight">\(\varepsilon_i \sim \mathcal{N}(0, 1)\)</span>) e gli errori <span class="math notranslate nohighlight">\(\varepsilon_i\)</span> e <span class="math notranslate nohighlight">\(\varepsilon_j\)</span> sono indipendenti per ogni <span class="math notranslate nohighlight">\(i \neq j\)</span>. Il valore atteso di <span class="math notranslate nohighlight">\(Y_i\)</span>  quindi <span class="math notranslate nohighlight">\(\mathbb{E}(Y_i) = \alpha + \beta X_i\)</span>, portando a:</p>
<div class="math notranslate nohighlight">
\[
\pi_i = \alpha + \beta X_i.
\]</div>
<p>Questo  noto come <em>modello lineare nelle probabilit</em> (<em>linear probability model</em>). Tuttavia, questo approccio presenta una limitazione significativa: non garantisce che i valori predetti di <span class="math notranslate nohighlight">\(\pi_i\)</span> siano confinati nellintervallo [0,1], come richiesto per le probabilit.</p>
<section id="problemi-di-normalita">
<h3>Problemi di Normalit<a class="headerlink" href="#problemi-di-normalita" title="Link to this heading">#</a></h3>
<p>Considerando che <span class="math notranslate nohighlight">\(Y_i\)</span> pu assumere solo i valori 0 o 1, i residui <span class="math notranslate nohighlight">\(\varepsilon_i\)</span> risultano anchessi dicotomici e quindi non possono seguire una distribuzione normale. Ad esempio, se <span class="math notranslate nohighlight">\(Y_i=1\)</span> con probabilit <span class="math notranslate nohighlight">\(\pi_i\)</span>, il residuo sar:</p>
<div class="math notranslate nohighlight">
\[
\varepsilon_i = 1 - \mathbb{E}(Y_i) = 1 - (\alpha + \beta X_i) = 1 - \pi_i.
\]</div>
<p>Se, invece, <span class="math notranslate nohighlight">\(Y_i=0\)</span> con probabilit <span class="math notranslate nohighlight">\(1-\pi_i\)</span>, il residuo sar:</p>
<div class="math notranslate nohighlight">
\[
\varepsilon_i = 0 - \mathbb{E}(Y_i) = 0 - (\alpha + \beta X_i) = - \pi_i.
\]</div>
<p>Tuttavia, se la dimensione del campione  grande, il teorema del limite centrale pu mitigare limportanza dellassunzione di normalit per le stime dei minimi quadrati.</p>
</section>
<section id="problematiche-di-eteroschedasticita">
<h3>Problematiche di Eteroschedasticit<a class="headerlink" href="#problematiche-di-eteroschedasticita" title="Link to this heading">#</a></h3>
<p>Utilizzare il metodo dei minimi quadrati pu essere inappropriato in questo contesto poich la varianza dei residui non  costante ma dipende dalla media, e quindi dalla variabile <span class="math notranslate nohighlight">\(X\)</span>. Assumendo che il modello sia lineare, abbiamo che <span class="math notranslate nohighlight">\(\mathbb{E}(\varepsilon_i)=0\)</span>. Sfruttando le relazioni discusse in precedenza, la varianza dei residui si calcola come:</p>
<div class="math notranslate nohighlight">
\[
\mathbb{V}(\varepsilon_i) = (1-\pi_i)\pi_i.
\]</div>
<p>Consideriamo che la varianza dei residui <span class="math notranslate nohighlight">\(\varepsilon_i\)</span> pu essere espressa come:</p>
<div class="math notranslate nohighlight">
\[
\text{Var}(\varepsilon_i) = \mathbb{E}(\varepsilon_i^2) - \mathbb{E}(\varepsilon_i)^2,
\]</div>
<p>dove <span class="math notranslate nohighlight">\(\mathbb{E}(\varepsilon_i^2)\)</span>  il valore atteso del quadrato dei residui e <span class="math notranslate nohighlight">\(\mathbb{E}(\varepsilon_i)^2\)</span>  il quadrato del valore atteso dei residui.</p>
<p>Ora calcoliamo <span class="math notranslate nohighlight">\(\mathbb{E}(\varepsilon_i^2)\)</span>:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align*}
\mathbb{E}(\varepsilon_i^2) &amp;= \mathbb{E}[(Y_i - \mathbb{E}(Y_i))^2] \\
&amp;= \mathbb{E}[(Y_i - \pi_i)^2] \\
&amp;= \mathbb{E}[(Y_i^2 - 2Y_i\pi_i + \pi_i^2)] \\
&amp;= \mathbb{E}(Y_i^2) - 2\mathbb{E}(Y_i\pi_i) + \mathbb{E}(\pi_i^2) \\
&amp;= \mathbb{E}(Y_i) - 2\mathbb{E}(Y_i\pi_i) + \pi_i^2 \\
&amp;= \pi_i - 2\pi_i^2 + \pi_i^2 \\
&amp;= \pi_i - \pi_i^2 \\
&amp;= \pi_i(1 - \pi_i)
\end{align*}
\end{split}\]</div>
<p>Ora calcoliamo <span class="math notranslate nohighlight">\(\mathbb{E}(\varepsilon_i)^2\)</span>:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align*}
\mathbb{E}(\varepsilon_i)^2 &amp;= (\mathbb{E}(Y_i - \mathbb{E}(Y_i)))^2 \\
&amp;= (\mathbb{E}(Y_i - \pi_i))^2 \\
&amp;= (0)^2 \\
&amp;= 0
\end{align*}
\end{split}\]</div>
<p>Quindi, sostituendo questi risultati nella formula della varianza dei residui, otteniamo:</p>
<div class="math notranslate nohighlight">
\[
\text{Var}(\varepsilon_i) = \mathbb{E}(\varepsilon_i^2) - \mathbb{E}(\varepsilon_i)^2 = \pi_i(1 - \pi_i)
\]</div>
<p>Quindi, abbiamo dimostrato che la varianza dei residui nel modello lineare nelle probabilit pu essere espressa come <span class="math notranslate nohighlight">\((1-\pi_i)\pi_i\)</span>.</p>
<p>Dato che <span class="math notranslate nohighlight">\(\pi_i\)</span> dipende da <span class="math notranslate nohighlight">\(x\)</span>, ci significa che la varianza non  costante in funzione di <span class="math notranslate nohighlight">\(x\)</span>. Questa eteroschedasticit dei residui rappresenta un problema per le stime dei minimi quadrati nel modello lineare, specialmente quando le probabilit <span class="math notranslate nohighlight">\(\pi_i\)</span> sono vicine a 0 o 1.</p>
</section>
<section id="linearita">
<h3>Linearit<a class="headerlink" href="#linearita" title="Link to this heading">#</a></h3>
<p>Il maggiore inconveniente connesso alladozione del modello lineare nelle probabilit deriva dal fatto che la stima della probabilit di successo, <span class="math notranslate nohighlight">\(P(\hat{Y}_i=1)=\hat{\pi}_i\)</span>, non  necessariamente compresa nellintervallo <span class="math notranslate nohighlight">\((0,1)\)</span>, ma pu essere sia negativa sia maggiore di 1. Nel caso dellesempio in discussione, ci significa che la retta dei minimi quadrati produce valori attesi <span class="math notranslate nohighlight">\(\hat{\pi}\)</span> inferiori a 0 per bassi valori della variabile <span class="math notranslate nohighlight">\(X\)</span> e valori <span class="math notranslate nohighlight">\(\hat{\pi}\)</span> superiori a 1 per valori di <span class="math notranslate nohighlight">\(X\)</span> alti.</p>
</section>
</section>
<section id="modello-lineare-nelle-probabilita-vincolato">
<h2>Modello Lineare nelle Probabilit Vincolato<a class="headerlink" href="#modello-lineare-nelle-probabilita-vincolato" title="Link to this heading">#</a></h2>
<p>Una soluzione per mantenere <span class="math notranslate nohighlight">\(\pi\)</span> allinterno dellintervallo (0, 1)  la seguente specificazione del modello:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\pi=
\begin{cases}
  0                           &amp;\text{se $\alpha + \beta X &lt; 0$},\\
  \alpha + \beta X           &amp;\text{se $0 \leq \alpha + \beta X \leq 1$},\\
  1 &amp;\text{se $\alpha + \beta X &gt; 1$}.
\end{cases}
\end{split}\]</div>
<p>Questo <em>modello lineare nelle probabilit vincolato</em> mostra alcune instabilit, soprattutto a causa della sua dipendenza critica dai valori estremi di <span class="math notranslate nohighlight">\(\pi\)</span>, dove assume i valori 0 o 1. La linearit di <span class="math notranslate nohighlight">\(\pi = \alpha + \beta X\)</span> si basa fortemente sui punti in cui si verificano questi estremi. In particolare, la stima di <span class="math notranslate nohighlight">\(\pi = 0\)</span> pu essere influenzata dal valore minimo di <span class="math notranslate nohighlight">\(X\)</span> associato a <span class="math notranslate nohighlight">\(Y=1\)</span>, mentre la stima di <span class="math notranslate nohighlight">\(\pi = 1\)</span> pu dipendere dal valore massimo di <span class="math notranslate nohighlight">\(X\)</span> per cui <span class="math notranslate nohighlight">\(Y=0\)</span>. Questi valori estremi tendono a variare significativamente tra diversi campioni e possono diventare pi estremi allaumentare della dimensione del campione.</p>
<p>La presenza di pi variabili esplicative (<span class="math notranslate nohighlight">\(k \geq 2\)</span>) complica ulteriormente la stima dei parametri del modello. Inoltre, il modello mostra un cambiamento brusco nella pendenza della curva di regressione ai punti estremi (0 e 1 di <span class="math notranslate nohighlight">\(\pi\)</span>), risultando poco realistico in molte situazioni pratiche. Questo rende il modello meno adatto a descrivere relazioni complesse e gradualmente variabili tra <span class="math notranslate nohighlight">\(\pi\)</span> e <span class="math notranslate nohighlight">\(X\)</span>.</p>
<p>Una funzione che modella una relazione pi fluida e continua tra <span class="math notranslate nohighlight">\(\pi\)</span> e <span class="math notranslate nohighlight">\(X\)</span> sarebbe pi realistica e rappresentativa delle dinamiche osservate. Questo motiva la preferenza per modelli alternativi, come il modello di regressione logistica, che tende a fornire una rappresentazione pi accurata e realistica delle interazioni tra variabili dicotomiche e esplicative.</p>
</section>
<section id="regressione-logistica">
<h2>Regressione Logistica<a class="headerlink" href="#regressione-logistica" title="Link to this heading">#</a></h2>
<p>Un metodo efficace per gestire il problema del vincolo sulle probabilit  specificare modelli non direttamente per le probabilit stesse, ma per una loro trasformazione che elimina tale vincolo. Invece di definire un modello lineare per la probabilit condizionata <span class="math notranslate nohighlight">\(\pi_i\)</span>, si pu specificare un modello lineare per il logaritmo degli odds (logit):</p>
<div class="math notranslate nohighlight">
\[
\eta_i = \log_e \frac{\pi_i}{1-\pi_i} = \alpha + \beta x_i,
\]</div>
<p>Questo approccio non presenta problemi poich il logit <span class="math notranslate nohighlight">\(\eta_i\)</span>  sempre un numero reale, permettendo di modellare una trasformazione lineare di <span class="math notranslate nohighlight">\(\pi_i\)</span>. La trasformazione inversa, che ci permette di ottenere <span class="math notranslate nohighlight">\(\pi_i\)</span> da <span class="math notranslate nohighlight">\(\eta_i\)</span>,  data dalla funzione logistica:</p>
<div class="math notranslate nohighlight">
\[
\pi_i = \frac{e^{\eta_i}}{1 + e^{\eta_i}} = \frac{e^{\alpha + \beta x_i}}{1 + e^{\alpha + \beta x_i}}.
\]</div>
<section id="vantaggi-della-regressione-logistica">
<h3>Vantaggi della Regressione Logistica<a class="headerlink" href="#vantaggi-della-regressione-logistica" title="Link to this heading">#</a></h3>
<p>La regressione logistica presenta diversi vantaggi rispetto al modello lineare delle probabilit:</p>
<ol class="arabic simple">
<li><p><strong>Vincolo delle Probabilit:</strong> La trasformazione logistica assicura che i valori predetti di <span class="math notranslate nohighlight">\(\pi_i\)</span> siano sempre compresi nellintervallo [0,1].</p></li>
<li><p><strong>Interpretabilit degli Odds Ratio:</strong> Il coefficiente <span class="math notranslate nohighlight">\(\beta\)</span> pu essere interpretato come il cambiamento logaritmico negli odds di successo associato a un incremento unitario di <span class="math notranslate nohighlight">\(X\)</span>. In altre parole, <span class="math notranslate nohighlight">\(e^\beta\)</span> rappresenta il fattore di aumento (o diminuzione) degli odds per un incremento unitario della variabile indipendente.</p></li>
<li><p><strong>Gestione dellEteroschedasticit:</strong> La forma funzionale della varianza del modello di regressione logistica <span class="math notranslate nohighlight">\(\pi_i (1 - \pi_i)\)</span>  intrinsecamente considerata nel processo di stima tramite il metodo della massima verosimiglianza.</p></li>
</ol>
</section>
<section id="esempio-pratico">
<h3>Esempio Pratico<a class="headerlink" href="#esempio-pratico" title="Link to this heading">#</a></h3>
<p>Per illustrare lapplicazione della regressione logistica, consideriamo nuovamente i dati simulati precedentemente. Applichiamo il modello di regressione logistica ai dati e tracciamo la curva logistica risultante:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot mean success rates with standard errors</span>
<span class="n">sns</span><span class="o">.</span><span class="n">pointplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">mean_success_rate</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">mean_success_rate</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">capsize</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>  <span class="c1"># Use linestyle=&#39;none&#39; to avoid connecting lines</span>
<span class="n">plt</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">mean_success_rate</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">mean_success_rate</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">yerr</span><span class="o">=</span><span class="n">standard_error</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>

<span class="c1"># Fit logistic regression model and plot logistic curve</span>
<span class="n">X_design</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">add_constant</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="n">logit_model</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">Logit</span><span class="p">(</span><span class="n">Y</span><span class="p">,</span> <span class="n">X_design</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">x_vals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">X</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">y_vals</span> <span class="o">=</span> <span class="n">logit_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">sm</span><span class="o">.</span><span class="n">add_constant</span><span class="p">(</span><span class="n">x_vals</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_vals</span><span class="p">,</span> <span class="n">y_vals</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Logistic Regression Curve&#39;</span><span class="p">)</span>

<span class="c1"># Customizing the plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Mean Success Rate&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Display the plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Optimization terminated successfully.
         Current function value: 0.289256
         Iterations 8
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/bd4a43a1f1bea11603270ad003641829ee825fa8556f3b7d1eb65619bc17bcb9.png"><img alt="../_images/bd4a43a1f1bea11603270ad003641829ee825fa8556f3b7d1eb65619bc17bcb9.png" src="../_images/bd4a43a1f1bea11603270ad003641829ee825fa8556f3b7d1eb65619bc17bcb9.png" style="width: 731px; height: 491px;" /></a>
</div>
</div>
<p>Questo esempio dimostra come la regressione logistica possa essere utilizzata per modellare una variabile dicotomica in funzione di una variabile indipendente. La curva logistica risultante rappresenta adeguatamente la relazione tra <span class="math notranslate nohighlight">\(X\)</span> e la probabilit di successo <span class="math notranslate nohighlight">\(Y\)</span>, garantendo che i valori predetti di <span class="math notranslate nohighlight">\(\pi_i\)</span> siano sempre compresi nellintervallo [0,1].</p>
<p>Nelle sezioni seguenti, descriveremo in dettaglio il modello di regressione logistica utilizzato per generare la curva logistica mostrata nella figura precedente. Inizieremo chiarendo i concetti di odds e logit e la loro relazione con le probabilit.</p>
</section>
</section>
<section id="probabilita-odds-e-logit">
<h2>Probabilit, Odds e Logit<a class="headerlink" href="#probabilita-odds-e-logit" title="Link to this heading">#</a></h2>
<p>La relazione tra probabilit, odds e logit  fondamentale per comprendere la regressione logistica. Questa relazione trasforma lintervallo di probabilit (0, 1) in uno spettro pi ampio, rendendo possibile modellare le probabilit con un modello lineare.</p>
<p>Gli odds rappresentano il rapporto tra la probabilit di un evento e la probabilit del suo complemento. Il logit, invece,  il logaritmo naturale degli odds, trasformando cos lintervallo di probabilit in tutta la linea dei numeri reali. Quando la probabilit  0.5, gli odds sono 1 e il logit  0. Logit negativi indicano probabilit inferiori a 0.5, mentre logit positivi indicano probabilit superiori a 0.5.</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Probabilit (P)</p></th>
<th class="head"><p>Odds (O)</p></th>
<th class="head"><p>logit (L)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0.01</p></td>
<td><p>0.01 / 0.99 = 0.0101</p></td>
<td><p><span class="math notranslate nohighlight">\(\ln(\frac{0.01}{0.99}) = -4.60\)</span></p></td>
</tr>
<tr class="row-odd"><td><p>0.05</p></td>
<td><p>0.05 / 0.95 = 0.0526</p></td>
<td><p><span class="math notranslate nohighlight">\(\ln(\frac{0.05}{0.95}) = -2.94\)</span></p></td>
</tr>
<tr class="row-even"><td><p>0.10</p></td>
<td><p>0.10 / 90 = 0.1111</p></td>
<td><p><span class="math notranslate nohighlight">\(\ln(\frac{0.10}{0.90}) = -2.20\)</span></p></td>
</tr>
<tr class="row-odd"><td><p>0.30</p></td>
<td><p>0.30 / 0.70 = 0.4286</p></td>
<td><p><span class="math notranslate nohighlight">\(\ln(\frac{0.30}{0.70}) = -0.85\)</span></p></td>
</tr>
<tr class="row-even"><td><p>0.50</p></td>
<td><p>0.50 / 0.50 = 1</p></td>
<td><p><span class="math notranslate nohighlight">\(\ln(\frac{0.50}{0.50}) = 0.00\)</span></p></td>
</tr>
<tr class="row-odd"><td><p>0.70</p></td>
<td><p>0.70 / 0.30 = 2.3333</p></td>
<td><p><span class="math notranslate nohighlight">\(\ln(\frac{0.70}{0.30}) = 0.85\)</span></p></td>
</tr>
<tr class="row-even"><td><p>0.90</p></td>
<td><p>0.90 / 0.10 = 9</p></td>
<td><p><span class="math notranslate nohighlight">\(\ln(\frac{0.90}{0.10}) = 2.20\)</span></p></td>
</tr>
<tr class="row-odd"><td><p>0.95</p></td>
<td><p>0.95 / 0.05 = 19</p></td>
<td><p><span class="math notranslate nohighlight">\(\ln(\frac{0.95}{0.05}) = 2.94\)</span></p></td>
</tr>
<tr class="row-even"><td><p>0.99</p></td>
<td><p>0.99 / 0.01 = 99</p></td>
<td><p><span class="math notranslate nohighlight">\(\ln(\frac{0.99}{0.01}) = 4.60\)</span></p></td>
</tr>
</tbody>
</table>
</div>
<section id="trasformazione-inversa-del-logit">
<h3>Trasformazione Inversa del Logit<a class="headerlink" href="#trasformazione-inversa-del-logit" title="Link to this heading">#</a></h3>
<p>La trasformazione inversa del logit, detta <em>antilogit</em>, consente di trasformare i logit in probabilit:</p>
<div class="math notranslate nohighlight">
\[
  \pi_i = \frac{e^{\eta_i}}{1 + e^{\eta_i}}.
\]</div>
<p>Grazie a questa trasformazione, possiamo passare dai logit alle probabilit. La trasformazione inversa del logit permette di specificare un modello non lineare per le probabilit <span class="math notranslate nohighlight">\(\pi_i\)</span>. Tale modello non lineare  detto <em>logit</em> o modello di regressione logistica:</p>
<div class="math notranslate nohighlight">
\[
  \pi_i = \frac{e^{\eta_i}}{1 + e^{\eta_i}} = \frac{e^{\alpha + \beta x_i}}{1 + e^{\alpha + \beta x_i}}.
\]</div>
<p>Questo modello garantisce che le probabilit <span class="math notranslate nohighlight">\(\pi_i\)</span> siano sempre comprese nellintervallo [0,1], risolvendo i problemi del modello lineare nelle probabilit e fornendo una rappresentazione accurata della relazione tra la variabile indipendente <span class="math notranslate nohighlight">\(X\)</span> e la probabilit di successo <span class="math notranslate nohighlight">\(Y\)</span>.</p>
<p>La funzione logistica ben rappresenta landamento sigmoidale delle proporzioni di casi <span class="math notranslate nohighlight">\(Y=1\)</span>, ovvero <span class="math notranslate nohighlight">\(\hat{\pi}_i = E(Y \mid x_i)\)</span> in funzione di livelli crescenti della variabile <span class="math notranslate nohighlight">\(X\)</span>.</p>
</section>
</section>
<section id="modelli-lineari-generalizzati">
<h2>Modelli Lineari Generalizzati<a class="headerlink" href="#modelli-lineari-generalizzati" title="Link to this heading">#</a></h2>
<p>Nel caso di una variabile risposta binaria, il modello classico di regressione lineare si scontra con sfide specifiche:</p>
<ol class="arabic simple">
<li><p><strong>Distribuzione Binomiale</strong>: <span class="math notranslate nohighlight">\(Y_i\)</span> segue una distribuzione binomiale (con indice <span class="math notranslate nohighlight">\(n_i\)</span>, potenzialmente uguale a uno nel caso individuale), rendendo non applicabile lipotesi di normalit.</p></li>
<li><p><strong>Limiti delle Probabilit</strong>: Utilizzando una specificazione lineare come <span class="math notranslate nohighlight">\(\pi_i= \beta_0 + \beta_1 x_i\)</span>, si possono ottenere stime di probabilit esterne allintervallo 0-1.</p></li>
<li><p><strong>Varianze Non Costanti</strong>: La varianza di <span class="math notranslate nohighlight">\(\varepsilon\)</span> varia in base alla specificazione del modello di probabilit, seguendo la formula <span class="math notranslate nohighlight">\(V(\varepsilon_i)=\pi_i(1-\pi_i)\)</span>.</p></li>
</ol>
<p>Per superare queste sfide, si utilizzano i Modelli Lineari Generalizzati (GLM). Questi modelli consentono luso di variabili risposta di diversa natura e includono:</p>
<ul class="simple">
<li><p><strong>Regressione Lineare</strong>: Per variabili dipendenti continue e variabili esplicative continue o qualitative.</p></li>
<li><p><strong>Regressione Logistica</strong>: Per variabili risposta binarie.</p></li>
<li><p><strong>Modello Loglineare di Poisson</strong>: Per modellare frequenze in tabelle di contingenza.</p></li>
</ul>
<p>I GLM allentano alcune ipotesi fondamentali del modello lineare classico, come linearit, normalit della componente erratica, e omoschedasticit delle osservazioni. Sono strutturati in tre componenti principali:</p>
<ol class="arabic simple">
<li><p><strong>Componente Aleatoria</strong>: Definisce la distribuzione di probabilit della variabile risposta <span class="math notranslate nohighlight">\(Y\)</span>.</p></li>
<li><p><strong>Componente Sistematica</strong>: Specifica la relazione lineare tra le variabili esplicative e una trasformazione della variabile risposta.</p></li>
<li><p><strong>Funzione Legame</strong>: Trasforma la media attesa <span class="math notranslate nohighlight">\(\mathbb{E}(Y)\)</span> in un formato che possa essere modellato linearmente rispetto alle variabili esplicative. Non  la variabile risposta stessa ad essere modellizzata direttamente, ma una sua trasformazione, come il logit nel caso della regressione logistica.</p></li>
</ol>
<p>Esempi di combinazioni di componenti aleatorie, funzioni di legame e sistematiche nei GLM includono:</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Componente Aleatoria</p></th>
<th class="head"><p>Funzione Legame</p></th>
<th class="head"><p>Componente Sistematica</p></th>
<th class="head"><p>Modello</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Gaussiana</p></td>
<td><p>Identit</p></td>
<td><p>Continua</p></td>
<td><p>Regressione</p></td>
</tr>
<tr class="row-odd"><td><p>Gaussiana</p></td>
<td><p>Identit</p></td>
<td><p>Categoriale</p></td>
<td><p>Analisi della varianza</p></td>
</tr>
<tr class="row-even"><td><p>Gaussiana</p></td>
<td><p>Identit</p></td>
<td><p>Mista</p></td>
<td><p>Analisi della covarianza</p></td>
</tr>
<tr class="row-odd"><td><p>Binomiale</p></td>
<td><p>Logit</p></td>
<td><p>Mista</p></td>
<td><p>Regressione logistica</p></td>
</tr>
<tr class="row-even"><td><p>Poisson</p></td>
<td><p>Logaritmo</p></td>
<td><p>Mista</p></td>
<td><p>Modello Loglineare</p></td>
</tr>
</tbody>
</table>
</div>
<p>Questa struttura rende i GLM particolarmente flessibili e adatti a una vasta gamma di situazioni statistiche, superando i limiti del modello lineare classico.</p>
</section>
<section id="componente-sistematica">
<h2>Componente Sistematica<a class="headerlink" href="#componente-sistematica" title="Link to this heading">#</a></h2>
<p>La componente sistematica mette in relazione un vettore (<span class="math notranslate nohighlight">\(\eta_1, \eta_2, \dots, \eta_k\)</span>) con le variabili esplicative mediante un modello lineare. Sia <span class="math notranslate nohighlight">\(X_{ij}\)</span> il valore della <span class="math notranslate nohighlight">\(j\)</span>-esima variabile esplicativa (<span class="math notranslate nohighlight">\(j=1, 2, \dots, p\)</span>) per l<span class="math notranslate nohighlight">\(i\)</span>-esima osservazione (<span class="math notranslate nohighlight">\(i=1, \dots, k\)</span>). Allora</p>
<div class="math notranslate nohighlight">
\[
\eta_i = \sum_j \beta_j X_{ij}.
\]</div>
<p>Questa combinazione lineare di variabili esplicative  chiamata il <em>predittore lineare</em>. Un <span class="math notranslate nohighlight">\(X_{ij}=1, \forall i\)</span> viene utilizzato per il coefficiente dellintercetta del modello (talvolta denotata da <span class="math notranslate nohighlight">\(\alpha\)</span>).</p>
</section>
<section id="componente-aleatoria">
<h2>Componente Aleatoria<a class="headerlink" href="#componente-aleatoria" title="Link to this heading">#</a></h2>
<p>La  componente aleatoria del modello suppone lesistenza di
<span class="math notranslate nohighlight">\(k\)</span> osservazioni indipendenti <span class="math notranslate nohighlight">\(y_1, y_2, \dots, y_k\)</span>, ciascuna delle
quali viene trattata come la realizzazione di una variabile casuale
<span class="math notranslate nohighlight">\(Y_i\)</span>. Si assume che <span class="math notranslate nohighlight">\(Y_i\)</span> abbia una distribuzione binomiale:</p>
<div class="math notranslate nohighlight">
\[
Y_i \sim Bin(n_i, \pi_i)
\]</div>
<p>con parametri <span class="math notranslate nohighlight">\(n_i\)</span> e <span class="math notranslate nohighlight">\(\pi_i\)</span>. Per dati individuali (uno per ciascun valore <span class="math notranslate nohighlight">\(x_i\)</span>), <span class="math notranslate nohighlight">\(n_i=1,
    \forall i\)</span>.</p>
</section>
<section id="funzione-legame">
<h2>Funzione Legame<a class="headerlink" href="#funzione-legame" title="Link to this heading">#</a></h2>
<p>La  funzione legame <span class="math notranslate nohighlight">\(g(\cdot)\)</span>  mette in relazione il valore atteso della variabile risposta <span class="math notranslate nohighlight">\(Y_i\)</span> con la componente sistematica <span class="math notranslate nohighlight">\(\eta_i\)</span> del modello. Abbiamo visto che <span class="math notranslate nohighlight">\(\mathbb{E}(Y_i)=\pi_i\)</span>.
Che relazione c tra <span class="math notranslate nohighlight">\(\pi_i\)</span> e il predittore lineare <span class="math notranslate nohighlight">\(\eta_i= \alpha + \sum_j  \beta_j X_{ij}\)</span>?
La risposta a questa domanda  data dalla funzione legame:</p>
<div class="math notranslate nohighlight">
\[
\eta_i = g(\pi_i) = \ln{\frac{\pi_i}{1-\pi_i}}
\]</div>
<p>Si noti che la funzione legame non trasforma la variabile risposta <span class="math notranslate nohighlight">\(Y_i\)</span> ma bens il suo valore atteso <span class="math notranslate nohighlight">\(\pi_i\)</span>.</p>
<p>La funzione legame  invertibile: anzich trasformare il valore atteso nel predittore lineare si pu trasformare il predittore lineare nel valore atteso <span class="math notranslate nohighlight">\(\pi_i\)</span>:</p>
<div class="math notranslate nohighlight">
\[
\pi_i = \frac{e^{\eta_i}}{1+e^{\eta_i}} =  \frac{e^{\alpha + \sum_j  \beta_j X_{ij}}}{1+e^{\alpha + \sum_j  \beta_j X_{ij}}}.
\]</div>
<p>Si ottiene cos un modello non lineare per le probabilit <span class="math notranslate nohighlight">\(\pi_i\)</span>.</p>
<p>In conclusione, la regressione logistica estende il concetto di regressione lineare per modellare le probabilit condizionate di esiti Bernoulliani <span class="math notranslate nohighlight">\( Y \)</span>, adoperando la funzione logistica come collegamento per trasformare relazioni lineari tra predittori (<span class="math notranslate nohighlight">\( \eta_i = \beta_0 + \beta_1 X_{i} \)</span>) in probabilit nellintervallo [0,1]. Questo metodo permette di passare dalla modellazione diretta della probabilit <span class="math notranslate nohighlight">\( p \)</span> alla modellazione di una funzione di tale probabilit attraverso una relazione lineare, impiegando la funzione logit come funzione di collegamento.</p>
</section>
<section id="id1">
<h2>Modelli Lineari Generalizzati<a class="headerlink" href="#id1" title="Link to this heading">#</a></h2>
<p>Nel caso di una variabile risposta binaria, il modello classico di regressione lineare incontra alcune difficolt specifiche:</p>
<ol class="arabic simple">
<li><p><strong>Distribuzione Binomiale</strong>: <span class="math notranslate nohighlight">\(Y_i\)</span> segue una distribuzione binomiale, rendendo inapplicabile lipotesi di normalit.</p></li>
<li><p><strong>Limiti delle Probabilit</strong>: Utilizzando una specificazione lineare come <span class="math notranslate nohighlight">\(\pi_i = \beta_0 + \beta_1 x_i\)</span>, si possono ottenere stime di probabilit al di fuori dellintervallo 0-1.</p></li>
<li><p><strong>Varianze Non Costanti</strong>: La varianza dei residui <span class="math notranslate nohighlight">\(\varepsilon_i\)</span> varia in base alla specificazione del modello di probabilit, seguendo la formula <span class="math notranslate nohighlight">\(V(\varepsilon_i) = \pi_i(1 - \pi_i)\)</span>.</p></li>
</ol>
<p>Per superare queste sfide, si utilizzano i Modelli Lineari Generalizzati (GLM). Questi modelli consentono luso di variabili risposta di diversa natura e includono:</p>
<ul class="simple">
<li><p><strong>Regressione Lineare</strong>: Per variabili dipendenti continue.</p></li>
<li><p><strong>Regressione Logistica</strong>: Per variabili risposta binarie.</p></li>
<li><p><strong>Modello Loglineare di Poisson</strong>: Per modellare frequenze in tabelle di contingenza.</p></li>
</ul>
<p>I GLM allentano alcune ipotesi fondamentali del modello lineare classico, come linearit, normalit della componente erratica e omoschedasticit delle osservazioni. Sono strutturati in tre componenti principali:</p>
<ol class="arabic simple">
<li><p><strong>Componente Aleatoria</strong>: Definisce la distribuzione di probabilit della variabile risposta <span class="math notranslate nohighlight">\(Y\)</span>.</p></li>
<li><p><strong>Componente Sistematica</strong>: Specifica la relazione lineare tra le variabili esplicative e una trasformazione della variabile risposta.</p></li>
<li><p><strong>Funzione Legame</strong>: Trasforma la media attesa <span class="math notranslate nohighlight">\(\mathbb{E}(Y)\)</span> in un formato che possa essere modellato linearmente rispetto alle variabili esplicative. Non  la variabile risposta stessa ad essere modellata direttamente, ma una sua trasformazione, come il logit nel caso della regressione logistica.</p></li>
</ol>
<section id="combinazioni-di-componenti-nei-glm">
<h3>Combinazioni di Componenti nei GLM<a class="headerlink" href="#combinazioni-di-componenti-nei-glm" title="Link to this heading">#</a></h3>
<p>Esempi di combinazioni di componenti aleatorie, funzioni di legame e sistematiche nei GLM includono:</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Componente Aleatoria</p></th>
<th class="head"><p>Funzione Legame</p></th>
<th class="head"><p>Componente Sistematica</p></th>
<th class="head"><p>Modello</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Gaussiana</p></td>
<td><p>Identit</p></td>
<td><p>Continua</p></td>
<td><p>Regressione</p></td>
</tr>
<tr class="row-odd"><td><p>Binomiale</p></td>
<td><p>Logit</p></td>
<td><p>Continua</p></td>
<td><p>Regressione logistica</p></td>
</tr>
<tr class="row-even"><td><p>Poisson</p></td>
<td><p>Logaritmo</p></td>
<td><p>Continua</p></td>
<td><p>Modello Loglineare</p></td>
</tr>
</tbody>
</table>
</div>
<p>Questa struttura rende i GLM particolarmente flessibili e adatti a una vasta gamma di situazioni statistiche, superando i limiti del modello lineare classico.</p>
</section>
</section>
<section id="id2">
<h2>Componente Sistematica<a class="headerlink" href="#id2" title="Link to this heading">#</a></h2>
<p>La componente sistematica mette in relazione un vettore <span class="math notranslate nohighlight">\((\eta_1, \eta_2, \dots, \eta_k)\)</span> con le variabili esplicative mediante un modello lineare. Sia <span class="math notranslate nohighlight">\(X_{i}\)</span> il valore della variabile esplicativa continua per l<span class="math notranslate nohighlight">\(i\)</span>-esima osservazione (<span class="math notranslate nohighlight">\(i=1, \dots, k\)</span>). Allora:</p>
<div class="math notranslate nohighlight">
\[
\eta_i = \beta_0 + \beta_1 X_i.
\]</div>
<p>Questa combinazione lineare di variabili esplicative  chiamata il <em>predittore lineare</em>.</p>
</section>
<section id="id3">
<h2>Componente Aleatoria<a class="headerlink" href="#id3" title="Link to this heading">#</a></h2>
<p>La componente aleatoria del modello suppone lesistenza di <span class="math notranslate nohighlight">\(k\)</span> osservazioni indipendenti <span class="math notranslate nohighlight">\(y_1, y_2, \dots, y_k\)</span>, ciascuna delle quali viene trattata come la realizzazione di una variabile casuale <span class="math notranslate nohighlight">\(Y_i\)</span>. Si assume che <span class="math notranslate nohighlight">\(Y_i\)</span> abbia una distribuzione binomiale:</p>
<div class="math notranslate nohighlight">
\[
Y_i \sim \text{Bin}(1, \pi_i),
\]</div>
<p>con parametro <span class="math notranslate nohighlight">\(\pi_i\)</span>. Per dati individuali, <span class="math notranslate nohighlight">\(n_i=1\)</span> per tutti <span class="math notranslate nohighlight">\(i\)</span>.</p>
</section>
<section id="id4">
<h2>Funzione Legame<a class="headerlink" href="#id4" title="Link to this heading">#</a></h2>
<p>La funzione legame <span class="math notranslate nohighlight">\(g(\cdot)\)</span> mette in relazione il valore atteso della variabile risposta <span class="math notranslate nohighlight">\(Y_i\)</span> con la componente sistematica <span class="math notranslate nohighlight">\(\eta_i\)</span> del modello. Abbiamo visto che <span class="math notranslate nohighlight">\(\mathbb{E}(Y_i) = \pi_i\)</span>. La relazione tra <span class="math notranslate nohighlight">\(\pi_i\)</span> e il predittore lineare <span class="math notranslate nohighlight">\(\eta_i = \beta_0 + \beta_1 X_i\)</span>  data dalla funzione legame:</p>
<div class="math notranslate nohighlight">
\[
\eta_i = g(\pi_i) = \ln{\frac{\pi_i}{1 - \pi_i}}.
\]</div>
<p>Si noti che la funzione legame non trasforma la variabile risposta <span class="math notranslate nohighlight">\(Y_i\)</span> ma il suo valore atteso <span class="math notranslate nohighlight">\(\pi_i\)</span>.</p>
<p>La funzione legame  invertibile: anzich trasformare il valore atteso nel predittore lineare, si pu trasformare il predittore lineare nel valore atteso <span class="math notranslate nohighlight">\(\pi_i\)</span>:</p>
<div class="math notranslate nohighlight">
\[
\pi_i = \frac{e^{\eta_i}}{1 + e^{\eta_i}} = \frac{e^{\beta_0 + \beta_1 X_i}}{1 + e^{\beta_0 + \beta_1 X_i}}.
\]</div>
<p>Si ottiene cos un modello non lineare per le probabilit <span class="math notranslate nohighlight">\(\pi_i\)</span>.</p>
<section id="coefficienti-del-modello-nella-regressione-logistica-e-la-loro-interpretazione">
<h3>Coefficienti del Modello nella Regressione Logistica e la loro Interpretazione<a class="headerlink" href="#coefficienti-del-modello-nella-regressione-logistica-e-la-loro-interpretazione" title="Link to this heading">#</a></h3>
<p>Un aspetto cruciale per comprendere la relazione tra le variabili predittive e una variabile di risposta binaria  linterpretazione dei coefficienti del modello.</p>
<section id="interpretazione-sui-logit">
<h4>Interpretazione sui Logit<a class="headerlink" href="#interpretazione-sui-logit" title="Link to this heading">#</a></h4>
<p>Nella regressione logistica, ogni coefficiente <span class="math notranslate nohighlight">\(\beta_j\)</span> del modello pu essere interpretato direttamente in termini di log-odds, che sono i logaritmi delle probabilit di ottenere un evento con esito positivo (<span class="math notranslate nohighlight">\(y=1\)</span>). Quando interpretiamo i coefficienti:</p>
<ul class="simple">
<li><p><strong>Coefficienti Positivi (<span class="math notranslate nohighlight">\(\beta_j &gt; 0\)</span>)</strong>: Un coefficiente positivo indica che c una relazione diretta tra il predittore e laumento dei log-odds di osservare levento di interesse. Questo significa che allaumentare del valore del predittore, la probabilit dellevento di interesse aumenta.</p></li>
<li><p><strong>Coefficienti Negativi (<span class="math notranslate nohighlight">\(\beta_j &lt; 0\)</span>)</strong>: Al contrario, un coefficiente negativo indica una relazione inversa tra il predittore e la probabilit logistica dellevento. Con laumentare del predittore, i log-odds e quindi la probabilit dellevento diminuiscono.</p></li>
</ul>
</section>
<section id="interpretazione-sugli-odds-ratio-or">
<h4>Interpretazione sugli Odds Ratio (OR)<a class="headerlink" href="#interpretazione-sugli-odds-ratio-or" title="Link to this heading">#</a></h4>
<p>Linterpretazione dei coefficienti nella regressione logistica pu estendersi agli odds ratio (OR), che forniscono informazioni sulla relazione tra i predittori e la probabilit dellevento di interesse. Per esempio, consideriamo un modello con un predittore continuo <span class="math notranslate nohighlight">\(X\)</span> e un coefficiente <span class="math notranslate nohighlight">\(\beta_1 = 0.50\)</span>. Il logaritmo naturale dellodds ratio, <span class="math notranslate nohighlight">\(\log(OR) = 0.50\)</span>, viene esponenziato per ottenere:</p>
<div class="math notranslate nohighlight">
\[
OR = e^{0.50} \approx 1.65.
\]</div>
<p>Questo risultato indica che per ununit di incremento in <span class="math notranslate nohighlight">\(X\)</span>, lodds di sperimentare levento di interesse  circa 1.65 volte maggiore. In altre parole, lincremento di una unit nel predittore <span class="math notranslate nohighlight">\(X\)</span> aumenta lodds di sperimentare levento di interesse di circa il 65%. Viceversa, un coefficiente negativo indicherebbe una diminuzione dellodds per un incremento di una unit in <span class="math notranslate nohighlight">\(X\)</span>.</p>
</section>
<section id="interpretazione-sulla-scala-delle-probabilita">
<h4>Interpretazione sulla Scala delle Probabilit<a class="headerlink" href="#interpretazione-sulla-scala-delle-probabilita" title="Link to this heading">#</a></h4>
<p>La regressione logistica consente di interpretare i coefficienti non solo in termini di log-odds, ma anche relativamente alle variazioni di probabilit. Consideriamo un modello che predice la probabilit di superare un esame basandosi sul numero di ore di studio (<span class="math notranslate nohighlight">\(X\)</span>).</p>
<p>Supponiamo che il coefficiente associato alle ore di studio sia <span class="math notranslate nohighlight">\(\beta_1 = 0.5\)</span>. Questo valore indica che ogni ora aggiuntiva di studio incrementa i log-odds di successo nellesame. Per comprendere limpatto di unora in pi di studio sulla probabilit di successo, possiamo utilizzare la seguente formula:</p>
<div class="math notranslate nohighlight">
\[
\Delta p = \frac{1}{1 + e^{-(\beta_0 + 0.5 \cdot (X_1 + 1))}} - \frac{1}{1 + e^{-(\beta_0 + 0.5 \cdot X_1)}}.
\]</div>
<p>Questa formula calcola la differenza tra la probabilit di successo dopo aver aggiunto unora di studio e la probabilit di successo prima di tale aggiunta. In termini pratici, <span class="math notranslate nohighlight">\(\Delta p\)</span> rappresenta lincremento della probabilit di superare lesame attribuibile a unora supplementare di studio. Questa interpretazione  cruciale per valutare quantitativamente leffetto delle ore di studio sulla probabilit di superare lesame.</p>
</section>
</section>
</section>
<section id="un-esempio-concreto">
<h2>Un esempio concreto<a class="headerlink" href="#un-esempio-concreto" title="Link to this heading">#</a></h2>
<p>Consideriamo nuovamente i dati simulati in precedenza</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>X</th>
      <th>Y</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>6</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>7</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>6</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Stimeremo ora i coefficienti del modello di regressione logistica usando Stan. Definiamo i dati nel formato atteso da Stan:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">stan_data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;N&quot;</span> <span class="p">:</span> <span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
    <span class="s2">&quot;y&quot;</span> <span class="p">:</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;Y&quot;</span><span class="p">],</span>
    <span class="s2">&quot;x&quot;</span> <span class="p">:</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;X&quot;</span><span class="p">]</span> 
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<p>Definiamo il modello di regressione logistica in uno script Stan:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">stan_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;stan&#39;</span><span class="p">,</span> <span class="s1">&#39;logistic_regression.stan&#39;</span><span class="p">)</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">stan_file</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data {
  int&lt;lower=0&gt; N;
  vector[N] x;
  array[N] int&lt;lower=0, upper=1&gt; y;
}
parameters {
  real alpha;
  real beta;
}
model {
  y ~ bernoulli_logit(alpha + beta * x);
}
</pre></div>
</div>
</div>
</div>
<p>Compiliamo il modello:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">CmdStanModel</span><span class="p">(</span><span class="n">stan_file</span><span class="o">=</span><span class="n">stan_file</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Eseguiamo il campionamento MCMC:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fit</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span>
    <span class="n">data</span><span class="o">=</span><span class="n">stan_data</span><span class="p">,</span>
    <span class="n">iter_warmup</span><span class="o">=</span><span class="mi">1_000</span><span class="p">,</span>
    <span class="n">iter_sampling</span><span class="o">=</span><span class="mi">2_000</span><span class="p">,</span>
    <span class="n">seed</span><span class="o">=</span><span class="mi">123</span><span class="p">,</span>
    <span class="n">show_progress</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">show_console</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>06:57:24 - cmdstanpy - INFO - CmdStan start processing
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>06:57:24 - cmdstanpy - INFO - Chain [1] start processing
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>06:57:24 - cmdstanpy - INFO - Chain [2] start processing
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>06:57:24 - cmdstanpy - INFO - Chain [3] start processing
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>06:57:24 - cmdstanpy - INFO - Chain [4] start processing
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>06:57:24 - cmdstanpy - INFO - Chain [3] done processing
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>06:57:24 - cmdstanpy - INFO - Chain [2] done processing
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>06:57:24 - cmdstanpy - INFO - Chain [4] done processing
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>06:57:24 - cmdstanpy - INFO - Chain [1] done processing
</pre></div>
</div>
</div>
</div>
<p>Esaminiamo le tracce:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">_</span> <span class="o">=</span> <span class="n">az</span><span class="o">.</span><span class="n">plot_trace</span><span class="p">(</span><span class="n">fit</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="../_images/c8a6f571dc42c5a26c9b82610ea4763d9e5eddf2756c59d59a846dd099abcca9.png"><img alt="../_images/c8a6f571dc42c5a26c9b82610ea4763d9e5eddf2756c59d59a846dd099abcca9.png" src="../_images/c8a6f571dc42c5a26c9b82610ea4763d9e5eddf2756c59d59a846dd099abcca9.png" style="width: 1211px; height: 411px;" /></a>
</div>
</div>
<p>Otteniamo le stime a posteriori dei parametri:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">az</span><span class="o">.</span><span class="n">summary</span><span class="p">(</span><span class="n">fit</span><span class="p">,</span> <span class="n">var_names</span><span class="o">=</span><span class="p">([</span><span class="s2">&quot;alpha&quot;</span><span class="p">,</span> <span class="s2">&quot;beta&quot;</span><span class="p">]),</span> <span class="n">hdi_prob</span><span class="o">=</span><span class="mf">0.95</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mean</th>
      <th>sd</th>
      <th>hdi_2.5%</th>
      <th>hdi_97.5%</th>
      <th>mcse_mean</th>
      <th>mcse_sd</th>
      <th>ess_bulk</th>
      <th>ess_tail</th>
      <th>r_hat</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>alpha</th>
      <td>-1.778</td>
      <td>0.18</td>
      <td>-2.132</td>
      <td>-1.436</td>
      <td>0.004</td>
      <td>0.003</td>
      <td>2261.0</td>
      <td>2634.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>beta</th>
      <td>1.004</td>
      <td>0.07</td>
      <td>0.869</td>
      <td>1.144</td>
      <td>0.001</td>
      <td>0.001</td>
      <td>2305.0</td>
      <td>2682.0</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Creiamo un nuovo DataFrame con 100 valori <span class="math notranslate nohighlight">\(x\)</span> nellintervallo [0, 9]:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">new_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="p">})</span>
<span class="n">new_data</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>x</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.090909</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.181818</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.272727</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.363636</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
    </tr>
    <tr>
      <th>95</th>
      <td>8.636364</td>
    </tr>
    <tr>
      <th>96</th>
      <td>8.727273</td>
    </tr>
    <tr>
      <th>97</th>
      <td>8.818182</td>
    </tr>
    <tr>
      <th>98</th>
      <td>8.909091</td>
    </tr>
    <tr>
      <th>99</th>
      <td>9.000000</td>
    </tr>
  </tbody>
</table>
<p>100 rows  1 columns</p>
</div></div></div>
</div>
<p>Otteniamo le medie a posteriori dei parametri <span class="math notranslate nohighlight">\(\alpha\)</span> e <span class="math notranslate nohighlight">\(\beta\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alpha</span> <span class="o">=</span> <span class="n">fit</span><span class="o">.</span><span class="n">stan_variable</span><span class="p">(</span><span class="s1">&#39;alpha&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">beta</span> <span class="o">=</span> <span class="n">fit</span><span class="o">.</span><span class="n">stan_variable</span><span class="p">(</span><span class="s1">&#39;beta&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> 
<span class="nb">print</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">beta</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-1.7784477 1.003503126
</pre></div>
</div>
</div>
</div>
<p>Calcoliamo i logit per ogni valore <span class="math notranslate nohighlight">\( x \)</span> nel dataset <code class="docutils literal notranslate"><span class="pre">new_data</span></code> utilizzando le stime a posteriori dei parametri <span class="math notranslate nohighlight">\(\alpha\)</span> e <span class="math notranslate nohighlight">\(\beta\)</span> ottenute dal modello di regressione logistica. Nel modello di regressione logistica, il logit della probabilit  una funzione lineare di <span class="math notranslate nohighlight">\( x \)</span>:</p>
<div class="math notranslate nohighlight">
\[
\log \left( \frac{p}{1-p} \right) = \alpha + \beta x
\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">logit_p</span> <span class="o">=</span> <span class="n">alpha</span> <span class="o">+</span> <span class="n">new_data</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">beta</span>
<span class="n">logit_p</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    -1.778448
1    -1.687220
2    -1.595993
3    -1.504765
4    -1.413537
        ...   
95    6.888170
96    6.979398
97    7.070625
98    7.161853
99    7.253080
Name: x, Length: 100, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>Esaminiamo graficamente la relazione tra il logit <span class="math notranslate nohighlight">\(\log \left( \frac{p}{1-p} \right)\)</span> e <span class="math notranslate nohighlight">\(x\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">new_data</span><span class="p">[</span><span class="s1">&#39;logit_p&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">logit_p</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">new_data</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">],</span> <span class="n">new_data</span><span class="p">[</span><span class="s1">&#39;logit_p&#39;</span><span class="p">],</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>  <span class="c1"># Plot con marcatori e linea</span>

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Logit Predetti in Funzione di X&#39;</span><span class="p">)</span>  <span class="c1"># Titolo del grafico</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">)</span>  <span class="c1"># Etichetta asse x</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Logit&#39;</span><span class="p">)</span>  <span class="c1"># Etichetta asse y</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="../_images/87266834dc1912733d08267715e89046e6e8331e536c4814ffca9fa817ad9c02.png"><img alt="../_images/87266834dc1912733d08267715e89046e6e8331e536c4814ffca9fa817ad9c02.png" src="../_images/87266834dc1912733d08267715e89046e6e8331e536c4814ffca9fa817ad9c02.png" style="width: 731px; height: 491px;" /></a>
</div>
</div>
<p>Calcoliamo i logit per ogni valore <span class="math notranslate nohighlight">\( x \)</span> nel dataset <code class="docutils literal notranslate"><span class="pre">new_data</span></code> utilizzando le stime a posteriori dei parametri <span class="math notranslate nohighlight">\(\alpha\)</span> e <span class="math notranslate nohighlight">\(\beta\)</span> ottenute dal modello di regressione logistica. Nel modello di regressione logistica, il logit della probabilit  una funzione lineare di <span class="math notranslate nohighlight">\( x \)</span>. Per ottenere la probabilit <span class="math notranslate nohighlight">\( p \)</span> dalla trasformazione del logit, possiamo utilizzare la funzione logistica inversa. Svolgiamo la conversione:</p>
<ol class="arabic">
<li><p>Calcoliamo il logit per ogni valore di <span class="math notranslate nohighlight">\( x \)</span>:</p>
<div class="math notranslate nohighlight">
\[
   \text{logit}_p = \alpha + \beta x
   \]</div>
</li>
<li><p>Applichiamo la funzione logistica inversa (antilogit) per ottenere la probabilit <span class="math notranslate nohighlight">\( p \)</span>:</p>
<div class="math notranslate nohighlight">
\[
   p = \frac{e^{\text{logit}_p}}{1 + e^{\text{logit}_p}} = \frac{e^{\alpha + \beta x}}{1 + e^{\alpha + \beta x}}
   \]</div>
</li>
</ol>
<p>Questa formula ci permette di trasformare il logit in una probabilit compresa tra 0 e 1 per ogni valore di <span class="math notranslate nohighlight">\( x \)</span> nel dataset <code class="docutils literal notranslate"><span class="pre">new_data</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">prob</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">logit_p</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">logit_p</span><span class="p">))</span>
<span class="c1"># Aggiungi le probabilit calcolate a `new_data`</span>
<span class="n">new_data</span><span class="p">[</span><span class="s1">&#39;prob&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">prob</span>
<span class="n">new_data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>x</th>
      <th>logit_p</th>
      <th>prob</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.000000</td>
      <td>-1.778448</td>
      <td>0.144495</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.090909</td>
      <td>-1.687220</td>
      <td>0.156142</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.181818</td>
      <td>-1.595993</td>
      <td>0.168542</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.272727</td>
      <td>-1.504765</td>
      <td>0.181716</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.363636</td>
      <td>-1.413537</td>
      <td>0.195677</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">new_data</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">],</span> <span class="n">new_data</span><span class="p">[</span><span class="s1">&#39;prob&#39;</span><span class="p">],</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>  <span class="c1"># Plot con marcatori e linea</span>

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Probabilit Predetta in Funzione di X&#39;</span><span class="p">)</span>  <span class="c1"># Titolo del grafico</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">)</span>  <span class="c1"># Etichetta asse x</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Probabilit Predetta&#39;</span><span class="p">)</span>  <span class="c1"># Etichetta asse y</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="../_images/05545c9c1d074d51d00b208f54d4b804f22b3c1a1d099c2c7ab848857e76c9f2.png"><img alt="../_images/05545c9c1d074d51d00b208f54d4b804f22b3c1a1d099c2c7ab848857e76c9f2.png" src="../_images/05545c9c1d074d51d00b208f54d4b804f22b3c1a1d099c2c7ab848857e76c9f2.png" style="width: 731px; height: 491px;" /></a>
</div>
</div>
<section id="interpretazione-dei-coefficienti-nella-regressione-logistica">
<h3>Interpretazione dei Coefficienti nella Regressione Logistica<a class="headerlink" href="#interpretazione-dei-coefficienti-nella-regressione-logistica" title="Link to this heading">#</a></h3>
<p>Abbiamo stimato i coefficienti <span class="math notranslate nohighlight">\(\alpha\)</span> e <span class="math notranslate nohighlight">\(\beta\)</span> dal modello di regressione logistica con i seguenti valori:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\alpha = -1.7784477\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\beta = 1.003503126\)</span></p></li>
</ul>
<p>Esamineremo ora linterpretazione di questi coefficienti sulla scala dei logit, dellodds ratio e delle probabilit.</p>
<section id="la-regola-del-dividere-per-4">
<h4>La regola del dividere per 4<a class="headerlink" href="#la-regola-del-dividere-per-4" title="Link to this heading">#</a></h4>
<p>La regola del dividere per 4  un metodo utile per interpretare i coefficienti della regressione logistica. Dividendo il coefficiente <span class="math notranslate nohighlight">\(\beta\)</span> per 4, si ottiene unapprossimazione della massima variazione nella probabilit <span class="math notranslate nohighlight">\(\Pr(y = 1)\)</span> per un incremento unitario in <span class="math notranslate nohighlight">\( x \)</span>, in corrispondenza di <span class="math notranslate nohighlight">\( p = 0.5 \)</span>.</p>
<p>La curva logistica  pi ripida al centro, dove <span class="math notranslate nohighlight">\( \alpha + \beta x = 0 \)</span> e quindi <span class="math notranslate nohighlight">\( \text{logit}^{-1}(\alpha + \beta x) = 0.5 \)</span>. In questo punto, la pendenza della curva, ovvero la derivata della funzione logistica,  massima e raggiunge il valore <span class="math notranslate nohighlight">\( \beta / 4 \)</span>.</p>
<p>Per esempio, nel modello con <span class="math notranslate nohighlight">\( \alpha = -1.778 \)</span> e <span class="math notranslate nohighlight">\( \beta = 1.003 \)</span>, dividendo <span class="math notranslate nohighlight">\(\beta\)</span> per 4 otteniamo circa 0.25. Questo valore rappresenta laumento massimo, in termini di probabilit, che possiamo aspettarci per un incremento unitario in <span class="math notranslate nohighlight">\( x \)</span>, in corrispondenza di <span class="math notranslate nohighlight">\( p = 0.5 \)</span>.</p>
<p>In sintesi, la regola del dividere per 4 semplifica linterpretazione dei coefficienti della regressione logistica, fornendo unindicazione intuitiva di come la variabile indipendente influisce sulla probabilit dellevento di interesse.</p>
</section>
<section id="scala-dei-logit">
<h4>Scala dei Logit<a class="headerlink" href="#scala-dei-logit" title="Link to this heading">#</a></h4>
<p>Nella regressione logistica, la funzione logit rappresenta una relazione lineare tra il logit della probabilit di successo e la variabile indipendente <span class="math notranslate nohighlight">\(X\)</span>:</p>
<div class="math notranslate nohighlight">
\[
\log \left( \frac{p}{1-p} \right) = \alpha + \beta x
\]</div>
<p>Con i coefficienti stimati, la funzione logit diventa:</p>
<div class="math notranslate nohighlight">
\[
\log \left( \frac{p}{1-p} \right) = -1.7784477 + 1.003503126 \cdot x
\]</div>
<ul class="simple">
<li><p><strong><span class="math notranslate nohighlight">\(\alpha = -1.7784477\)</span></strong>: Questo  lintercetta del modello, il valore del logit quando <span class="math notranslate nohighlight">\(x = 0\)</span>. Indica che, quando <span class="math notranslate nohighlight">\(x\)</span>  0, il logit della probabilit di successo  <span class="math notranslate nohighlight">\(-1.7784477\)</span>.</p></li>
<li><p><strong><span class="math notranslate nohighlight">\(\beta = 1.003503126\)</span></strong>: Questo  il coefficiente di <span class="math notranslate nohighlight">\(x\)</span> e rappresenta il cambiamento nel logit per ogni incremento unitario in <span class="math notranslate nohighlight">\(x\)</span>. In altre parole, per ogni incremento di 1 unit in <span class="math notranslate nohighlight">\(x\)</span>, il logit della probabilit di successo aumenta di circa <span class="math notranslate nohighlight">\(1.003503126\)</span>.</p></li>
</ul>
</section>
<section id="odds-ratio">
<h4>Odds Ratio<a class="headerlink" href="#odds-ratio" title="Link to this heading">#</a></h4>
<p>Lodds ratio (OR) misura il cambiamento relativo nelle odds di successo per un incremento unitario in <span class="math notranslate nohighlight">\(x\)</span>.  ottenuto esponenziando il coefficiente <span class="math notranslate nohighlight">\(\beta\)</span>:</p>
<div class="math notranslate nohighlight">
\[
\text{OR} = e^{\beta} = e^{1.003503126} \approx 2.728
\]</div>
<p>Un odds ratio di circa <span class="math notranslate nohighlight">\(2.728\)</span> indica che, per ogni incremento unitario in <span class="math notranslate nohighlight">\(x\)</span>, le odds di successo aumentano di circa <span class="math notranslate nohighlight">\(172.8\%\)</span>. In altre parole, lodds di successo  circa <span class="math notranslate nohighlight">\(2.728\)</span> volte maggiore per ogni unit aggiuntiva di <span class="math notranslate nohighlight">\(x\)</span>.</p>
</section>
<section id="scala-delle-probabilita">
<h4>Scala delle Probabilit<a class="headerlink" href="#scala-delle-probabilita" title="Link to this heading">#</a></h4>
<p>Per interpretare leffetto di <span class="math notranslate nohighlight">\(\beta\)</span> sulla scala delle probabilit, possiamo considerare come la probabilit <span class="math notranslate nohighlight">\(p\)</span> cambia in corrispondenza di specifici valori di <span class="math notranslate nohighlight">\(x\)</span>.</p>
<ol class="arabic simple">
<li><p>Quando <span class="math notranslate nohighlight">\(x = 0\)</span>:</p></li>
</ol>
<div class="math notranslate nohighlight">
\[
\log \left( \frac{p}{1-p} \right) = -1.7784477
\]</div>
<p>Invertendo il logit per ottenere <span class="math notranslate nohighlight">\(p\)</span>:</p>
<div class="math notranslate nohighlight">
\[
p = \frac{e^{-1.7784477}}{1 + e^{-1.7784477}} \approx \frac{0.169} {1 + 0.169} \approx 0.144
\]</div>
<p>Quindi, la probabilit di successo quando <span class="math notranslate nohighlight">\(x = 0\)</span>  circa <span class="math notranslate nohighlight">\(14.4\%\)</span>.</p>
<ol class="arabic simple" start="2">
<li><p>Per un incremento unitario in <span class="math notranslate nohighlight">\(x\)</span>, diciamo <span class="math notranslate nohighlight">\(x = 1\)</span>:</p></li>
</ol>
<div class="math notranslate nohighlight">
\[
\log \left( \frac{p}{1-p} \right) = -1.7784477 + 1.003503126 \cdot 1 \approx -0.774944574
\]</div>
<p>Invertendo il logit per ottenere <span class="math notranslate nohighlight">\(p\)</span>:</p>
<div class="math notranslate nohighlight">
\[
p = \frac{e^{-0.774944574}}{1 + e^{-0.774944574}} \approx \frac{0.461} {1 + 0.461} \approx 0.316
\]</div>
<p>Quindi, la probabilit di successo quando <span class="math notranslate nohighlight">\(x = 1\)</span>  circa <span class="math notranslate nohighlight">\(31.6\%\)</span>. Tuttavia questo incremento non  costante per i diversi livelli <span class="math notranslate nohighlight">\(x\)</span> e il modo pi semplice per mostrare la relazione tra probabilit di successo e la variabile <span class="math notranslate nohighlight">\(X\)</span>  quella di generare un grafico come quello che abbimo prodotto in precedenza.</p>
</section>
</section>
<section id="riassunto">
<h3>Riassunto<a class="headerlink" href="#riassunto" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><strong>Scala dei Logit</strong>: Un incremento unitario in <span class="math notranslate nohighlight">\(x\)</span> aumenta il logit della probabilit di successo di <span class="math notranslate nohighlight">\(1.003503126\)</span>.</p></li>
<li><p><strong>Odds Ratio</strong>: Le odds di successo aumentano di circa <span class="math notranslate nohighlight">\(2.728\)</span> volte per ogni incremento unitario in <span class="math notranslate nohighlight">\(x\)</span>.</p></li>
<li><p><strong>Scala delle Probabilit</strong>: Quando <span class="math notranslate nohighlight">\(x\)</span> passa da 0 a 1, la probabilit di successo aumenta da circa <span class="math notranslate nohighlight">\(14.4\%\)</span> a <span class="math notranslate nohighlight">\(31.6\%\)</span>. Per la relazione tra ciascun livello <span class="math notranslate nohighlight">\(x\)</span> e la probabilit di successo  necessario generare un grafico.</p></li>
</ul>
<p>Questa analisi dimostra come i coefficienti del modello di regressione logistica possono essere interpretati su diverse scale, fornendo un quadro completo della relazione tra la variabile indipendente e la probabilit di successo.</p>
</section>
</section>
<section id="regressione-logistica-con-solo-l-intercetta">
<h2>Regressione logistica con solo lintercetta<a class="headerlink" href="#regressione-logistica-con-solo-l-intercetta" title="Link to this heading">#</a></h2>
<p>La regressione lineare con solo lintercetta  equivalente a stimare una media e la regressione lineare con un singolo predittore binario  equivalente a stimare una differenza tra medie. Allo stesso modo, la regressione logistica con solo lintercetta  equivalente alla stima di una proporzione.</p>
<p>Ecco un esempio. Un campione casuale di 50 persone viene testato e 10 di loro manifestano una certa caratteristica psicologica. La proporzione  0.20 con errore standard <span class="math notranslate nohighlight">\( \sqrt{0.2 \cdot 0.8 / 50} = 0.06 \)</span>. In alternativa, possiamo impostare questo come regressione logistica usando Bambi in Python:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Dati</span>
<span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">40</span> <span class="o">+</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mi">10</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="n">y</span><span class="p">})</span>

<span class="c1"># Modello</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">bmb</span><span class="o">.</span><span class="n">Model</span><span class="p">(</span><span class="s1">&#39;y ~ 1&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">family</span><span class="o">=</span><span class="s1">&#39;bernoulli&#39;</span><span class="p">)</span>
<span class="n">fit</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">nuts_sampler</span><span class="o">=</span><span class="s2">&quot;numpyro&quot;</span><span class="p">,</span> <span class="n">random_seed</span><span class="o">=</span><span class="mi">123</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Modeling the probability that y==1
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "832726e0d4e642159aeb895c3a1e2682", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "4fe0bc5ea2d84031af482e7d451feb06", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "87b3719dfe7443058775db8205482812", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "5d8155ef23a94bd3a023ca5f0c2fac3f", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">az</span><span class="o">.</span><span class="n">summary</span><span class="p">(</span><span class="n">fit</span><span class="p">,</span> <span class="n">round_to</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mean</th>
      <th>sd</th>
      <th>hdi_3%</th>
      <th>hdi_97%</th>
      <th>mcse_mean</th>
      <th>mcse_sd</th>
      <th>ess_bulk</th>
      <th>ess_tail</th>
      <th>r_hat</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Intercept</th>
      <td>-1.4</td>
      <td>0.35</td>
      <td>-2.04</td>
      <td>-0.72</td>
      <td>0.01</td>
      <td>0.01</td>
      <td>1512.28</td>
      <td>1566.65</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Possiamo trasformare la previsione nella scala delle probabilit e ottenere un risultato che  essenzialmente lo stesso della stima classica con incertezza di 0.20  0.06.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Given values</span>
<span class="n">intercept</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.4</span>
<span class="n">error</span> <span class="o">=</span> <span class="mf">0.35</span>

<span class="c1"># Calculate logit^-1(-1.41)</span>
<span class="n">p_hat</span> <span class="o">=</span> <span class="n">expit</span><span class="p">(</span><span class="n">intercept</span><span class="p">)</span>

<span class="c1"># Calculate logit^-1(-1.41  0.36)</span>
<span class="n">lower_bound</span> <span class="o">=</span> <span class="n">expit</span><span class="p">(</span><span class="n">intercept</span> <span class="o">-</span> <span class="n">error</span><span class="p">)</span>
<span class="n">upper_bound</span> <span class="o">=</span> <span class="n">expit</span><span class="p">(</span><span class="n">intercept</span> <span class="o">+</span> <span class="n">error</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;p_hat: </span><span class="si">{</span><span class="n">p_hat</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">, Lower bound: </span><span class="si">{</span><span class="n">lower_bound</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">, Upper bound: </span><span class="si">{</span><span class="n">upper_bound</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>p_hat: 0.198, Lower bound: 0.148, Upper bound: 0.259
</pre></div>
</div>
</div>
</div>
<p>Le stime classiche e quelle della regressione logistica differiscono leggermente, in parte perch Bambi usa una distribuzione a priori e in parte perch lerrore standard classico  solo unapprossimazione allincertezza inferenziale derivante dai dati discreti.</p>
</section>
<section id="regressione-logistica-con-un-singolo-predittore-binario">
<h2>Regressione logistica con un singolo predittore binario<a class="headerlink" href="#regressione-logistica-con-un-singolo-predittore-binario" title="Link to this heading">#</a></h2>
<p>La regressione logistica su una variabile indicatrice  equivalente a un confronto di proporzioni. Per un esempio semplice, consideriamo i test per una malattia su campioni provenienti da due popolazioni diverse, dove 10 su 50 individui della popolazione A risultano positivi, rispetto a 20 su 60 della popolazione B. La stima classica  0.13 con errore standard di 0.08. Ecco come impostare questo caso come regressione logistica utilizzando Bambi in Python:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Dati</span>
<span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">50</span> <span class="o">+</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="mi">60</span>
<span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">40</span> <span class="o">+</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="mi">10</span> <span class="o">+</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">40</span> <span class="o">+</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="mi">20</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="n">x</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="n">y</span><span class="p">})</span>

<span class="c1"># Definire il modello</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">bmb</span><span class="o">.</span><span class="n">Model</span><span class="p">(</span><span class="s1">&#39;y ~ x&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">family</span><span class="o">=</span><span class="s1">&#39;bernoulli&#39;</span><span class="p">)</span>

<span class="c1"># Adattare il modello con un seed</span>
<span class="n">fit</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">nuts_sampler</span><span class="o">=</span><span class="s2">&quot;numpyro&quot;</span><span class="p">,</span> <span class="n">random_seed</span><span class="o">=</span><span class="mi">123</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Modeling the probability that y==1
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "70856b87befe41faa357c732b6b8a3c6", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "5ef7fb8e4d3f4389a64c65ff48eceb0c", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "9badf7570e9b4ca4a201bdde2476f2ba", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "31b4079f0dda4fc0b6f0933209462c49", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Visualizzare i risultati del fit</span>
<span class="n">az</span><span class="o">.</span><span class="n">summary</span><span class="p">(</span><span class="n">fit</span><span class="p">,</span> <span class="n">round_to</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mean</th>
      <th>sd</th>
      <th>hdi_3%</th>
      <th>hdi_97%</th>
      <th>mcse_mean</th>
      <th>mcse_sd</th>
      <th>ess_bulk</th>
      <th>ess_tail</th>
      <th>r_hat</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Intercept</th>
      <td>-1.41</td>
      <td>0.36</td>
      <td>-2.09</td>
      <td>-0.76</td>
      <td>0.01</td>
      <td>0.01</td>
      <td>2636.26</td>
      <td>2468.61</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>x</th>
      <td>0.71</td>
      <td>0.45</td>
      <td>-0.13</td>
      <td>1.58</td>
      <td>0.01</td>
      <td>0.01</td>
      <td>3063.75</td>
      <td>2193.73</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Per ottenere linferenza per la differenza di probabilit, confrontiamo le previsioni sulla scala delle probabilit per <span class="math notranslate nohighlight">\( x = 0 \)</span> e <span class="math notranslate nohighlight">\( x = 1 \)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Given values</span>
<span class="n">intercept</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.41</span>
<span class="n">slope</span> <span class="o">=</span> <span class="mf">0.71</span>

<span class="c1"># Calculate probabilities for x = 0 and x = 1</span>
<span class="n">logit_0</span> <span class="o">=</span> <span class="n">intercept</span>
<span class="n">logit_1</span> <span class="o">=</span> <span class="n">intercept</span> <span class="o">+</span> <span class="n">slope</span>

<span class="n">prob_0</span> <span class="o">=</span> <span class="n">expit</span><span class="p">(</span><span class="n">logit_0</span><span class="p">)</span>
<span class="n">prob_1</span> <span class="o">=</span> <span class="n">expit</span><span class="p">(</span><span class="n">logit_1</span><span class="p">)</span>

<span class="c1"># Calculate the difference in probabilities</span>
<span class="n">diff</span> <span class="o">=</span> <span class="n">prob_1</span> <span class="o">-</span> <span class="n">prob_0</span>

<span class="n">prob_0</span><span class="p">,</span> <span class="n">prob_1</span><span class="p">,</span> <span class="n">diff</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;prob_0: </span><span class="si">{</span><span class="n">prob_0</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">, prob_1: </span><span class="si">{</span><span class="n">prob_1</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">, difference: </span><span class="si">{</span><span class="n">diff</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>prob_0: 0.196, prob_1: 0.332, difference: 0.136
</pre></div>
</div>
</div>
</div>
<p>Per lerrore standard possiamo eseguire la seguente simulazione:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Given values</span>
<span class="n">intercept_mean</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.41</span>
<span class="n">slope_mean</span> <span class="o">=</span> <span class="mf">0.71</span>
<span class="n">intercept_sd</span> <span class="o">=</span> <span class="mf">0.36</span>
<span class="n">slope_sd</span> <span class="o">=</span> <span class="mf">0.45</span>

<span class="c1"># Number of simulations</span>
<span class="n">num_simulations</span> <span class="o">=</span> <span class="mi">10000</span>

<span class="c1"># Generate samples of the coefficients</span>
<span class="n">intercept_samples</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">intercept_mean</span><span class="p">,</span> <span class="n">intercept_sd</span><span class="p">,</span> <span class="n">num_simulations</span><span class="p">)</span>
<span class="n">slope_samples</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">slope_mean</span><span class="p">,</span> <span class="n">slope_sd</span><span class="p">,</span> <span class="n">num_simulations</span><span class="p">)</span>

<span class="c1"># Calculate the corresponding probabilities</span>
<span class="n">prob_0_samples</span> <span class="o">=</span> <span class="n">expit</span><span class="p">(</span><span class="n">intercept_samples</span><span class="p">)</span>
<span class="n">prob_1_samples</span> <span class="o">=</span> <span class="n">expit</span><span class="p">(</span><span class="n">intercept_samples</span> <span class="o">+</span> <span class="n">slope_samples</span><span class="p">)</span>

<span class="c1"># Calculate the difference in probabilities for each sample</span>
<span class="n">diff_samples</span> <span class="o">=</span> <span class="n">prob_1_samples</span> <span class="o">-</span> <span class="n">prob_0_samples</span>

<span class="c1"># Calculate the mean and standard deviation of the differences</span>
<span class="n">mean_diff</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">diff_samples</span><span class="p">)</span>
<span class="n">std_diff</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">diff_samples</span><span class="p">)</span>

<span class="n">mean_diff</span><span class="p">,</span> <span class="n">std_diff</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;difference: </span><span class="si">{</span><span class="n">mean_diff</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">, standard error: </span><span class="si">{</span><span class="n">std_diff</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>difference: 0.140, standard error: 0.096
</pre></div>
</div>
</div>
</div>
<p>Sebbene abbiamo ottenuto un errore standard di circa 0.095, che  leggermente diverso dallerrore standard di 0.08 menzionato inizialmente, questo valore riflette lincertezza nelle stime dei coefficienti fornite. Potrebbero esserci delle variazioni dovute al metodo di campionamento utilizzato. Tuttavia, questi calcoli dimostrano lapproccio corretto per stimare lerrore standard utilizzando la simulazione Monte Carlo con le deviazioni standard dei coefficienti stimati. </p>
</section>
<section id="informazioni-sull-ambiente-di-sviluppo">
<h2>Informazioni sullAmbiente di Sviluppo<a class="headerlink" href="#informazioni-sull-ambiente-di-sviluppo" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">load_ext</span> watermark
<span class="o">%</span><span class="k">watermark</span> -n -u -v -iv -w -m -p cmdstanp
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Last updated: Thu Jun 20 2024

Python implementation: CPython
Python version       : 3.12.3
IPython version      : 8.25.0

cmdstanp: not installed

Compiler    : Clang 16.0.6 
OS          : Darwin
Release     : 23.5.0
Machine     : arm64
Processor   : arm
CPU cores   : 8
Architecture: 64bit

matplotlib : 3.8.4
arviz      : 0.18.0
pandas     : 2.2.2
statsmodels: 0.14.2
bambi      : 0.13.0
seaborn    : 0.13.2
scipy      : 1.13.1
numpy      : 1.26.4

Watermark: 2.4.3
</pre></div>
</div>
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./chapter_5"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="E_causal_inference.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">precedente</p>
        <p class="prev-next-title"> Esercizi</p>
      </div>
    </a>
    <a class="right-next"
       href="05_24_stan_mixed_models.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">successivo</p>
        <p class="prev-next-title">Modelli misti con Stan</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contenuti
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#regressione-logistica-bivariata">Regressione Logistica Bivariata</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#preparazione-del-notebook">Preparazione del Notebook</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modello-di-regressione-logistica-per-variabili-binarie">Modello di Regressione Logistica per Variabili Binarie</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modello-lineare-nelle-probabilita">Modello Lineare nelle Probabilit</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#problemi-di-normalita">Problemi di Normalit</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#problematiche-di-eteroschedasticita">Problematiche di Eteroschedasticit</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#linearita">Linearit</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modello-lineare-nelle-probabilita-vincolato">Modello Lineare nelle Probabilit Vincolato</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#regressione-logistica">Regressione Logistica</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#vantaggi-della-regressione-logistica">Vantaggi della Regressione Logistica</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#esempio-pratico">Esempio Pratico</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#probabilita-odds-e-logit">Probabilit, Odds e Logit</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#trasformazione-inversa-del-logit">Trasformazione Inversa del Logit</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modelli-lineari-generalizzati">Modelli Lineari Generalizzati</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#componente-sistematica">Componente Sistematica</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#componente-aleatoria">Componente Aleatoria</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#funzione-legame">Funzione Legame</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Modelli Lineari Generalizzati</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#combinazioni-di-componenti-nei-glm">Combinazioni di Componenti nei GLM</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Componente Sistematica</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">Componente Aleatoria</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">Funzione Legame</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#coefficienti-del-modello-nella-regressione-logistica-e-la-loro-interpretazione">Coefficienti del Modello nella Regressione Logistica e la loro Interpretazione</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#interpretazione-sui-logit">Interpretazione sui Logit</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#interpretazione-sugli-odds-ratio-or">Interpretazione sugli Odds Ratio (OR)</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#interpretazione-sulla-scala-delle-probabilita">Interpretazione sulla Scala delle Probabilit</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#un-esempio-concreto">Un esempio concreto</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#interpretazione-dei-coefficienti-nella-regressione-logistica">Interpretazione dei Coefficienti nella Regressione Logistica</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#la-regola-del-dividere-per-4">La regola del dividere per 4</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#scala-dei-logit">Scala dei Logit</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#odds-ratio">Odds Ratio</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#scala-delle-probabilita">Scala delle Probabilit</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#riassunto">Riassunto</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#regressione-logistica-con-solo-l-intercetta">Regressione logistica con solo lintercetta</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#regressione-logistica-con-un-singolo-predittore-binario">Regressione logistica con un singolo predittore binario</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#informazioni-sull-ambiente-di-sviluppo">Informazioni sullAmbiente di Sviluppo</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
Di Corrado Caudek
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
       Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=3ee479438cf8b5e0d341"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=3ee479438cf8b5e0d341"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>